<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>eqtools.EFIT &mdash; eqtools 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="eqtools 1.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">eqtools 1.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for eqtools.EFIT</h1><div class="highlight"><pre>
<span></span><span class="c1"># This program is distributed under the terms of the GNU General Purpose License (GPL).</span>
<span class="c1"># Refer to http://www.gnu.org/licenses/gpl.txt</span>
<span class="c1">#</span>
<span class="c1"># This file is part of EqTools.</span>
<span class="c1">#</span>
<span class="c1"># EqTools is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># EqTools is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with EqTools.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="kn">from</span> <span class="nn">.core</span> <span class="kn">import</span> <span class="n">Equilibrium</span><span class="p">,</span> <span class="n">ModuleWarning</span><span class="p">,</span> <span class="n">inPolygon</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">MDSplus</span>
    <span class="kn">from</span> <span class="nn">MDSplus._treeshr</span> <span class="kn">import</span> <span class="n">TreeException</span>
    <span class="n">_has_MDS</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_e_MDS</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_e_MDS</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MDSplus module could not be loaded -- classes that use &quot;</span>
                      <span class="s2">&quot;MDSplus for data access will not work.&quot;</span><span class="p">,</span>
                      <span class="n">ModuleWarning</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MDSplus module could not be loaded -- classes that use &quot;</span>
                      <span class="s2">&quot;MDSplus for data access will not work. Exception raised &quot;</span>
                      <span class="s2">&quot;was of type </span><span class="si">%s</span><span class="s2">, message was &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span>
                      <span class="o">%</span> <span class="p">(</span><span class="n">_e_MDS</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">_e_MDS</span><span class="o">.</span><span class="n">message</span><span class="p">),</span>
                      <span class="n">ModuleWarning</span><span class="p">)</span>
    <span class="n">_has_MDS</span> <span class="o">=</span> <span class="bp">False</span>
    
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="n">_has_plt</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Matplotlib.pyplot module could not be loaded -- classes that &quot;</span>
                  <span class="s2">&quot;use pyplot will not work.&quot;</span><span class="p">,</span><span class="n">ModuleWarning</span><span class="p">)</span>
    <span class="n">_has_plt</span> <span class="o">=</span> <span class="bp">False</span>

<div class="viewcode-block" id="EFITTree"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree">[docs]</a><span class="k">class</span> <span class="nc">EFITTree</span><span class="p">(</span><span class="n">Equilibrium</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inherits Equilibrium class. EFIT-specific data handling class for machines using</span>
<span class="sd">    standard EFIT tag names/tree structure with MDSplus. Constructor and/or data loading may</span>
<span class="sd">    need overriding in a machine-specific implementation.</span>
<span class="sd">    Pulls EFIT data from selected MDS tree and shot, stores as object attributes.</span>
<span class="sd">    Each EFIT variable or set of variables is recovered with a corresponding getter method.</span>
<span class="sd">    Essential data for EFIT mapping are pulled on initialization (e.g. psirz grid).</span>
<span class="sd">    Additional data are pulled at the first request and stored for subsequent usage.</span>
<span class="sd">    </span>
<span class="sd">    Intializes EFITTree object. Pulls data from MDS tree for storage in</span>
<span class="sd">    instance attributes. Core attributes are populated from the MDS tree</span>
<span class="sd">    on initialization. Additional attributes are initialized as None,</span>
<span class="sd">    filled on the first request to the object.</span>

<span class="sd">    Args:</span>
<span class="sd">        shot (integer): Shot number</span>
<span class="sd">        tree (string): MDSplus tree to open to fetch EFIT data.</span>
<span class="sd">        root (string): Root path for EFIT data in MDSplus tree.</span>
<span class="sd">    </span>
<span class="sd">    Keyword Args:</span>
<span class="sd">        length_unit (string): Sets the base unit used for any</span>
<span class="sd">            quantity whose dimensions are length to any power.</span>
<span class="sd">            Valid options are:</span>

<span class="sd">                ===========  ===========================================================================================</span>
<span class="sd">                &#39;m&#39;          meters</span>
<span class="sd">                &#39;cm&#39;         centimeters</span>
<span class="sd">                &#39;mm&#39;         millimeters</span>
<span class="sd">                &#39;in&#39;         inches</span>
<span class="sd">                &#39;ft&#39;         feet</span>
<span class="sd">                &#39;yd&#39;         yards</span>
<span class="sd">                &#39;smoot&#39;      smoots</span>
<span class="sd">                &#39;cubit&#39;      cubits</span>
<span class="sd">                &#39;hand&#39;       hands</span>
<span class="sd">                &#39;default&#39;    whatever the default in the tree is (no conversion is performed, units may be inconsistent)</span>
<span class="sd">                ===========  ===========================================================================================</span>

<span class="sd">            Default is &#39;m&#39; (all units taken and returned in meters).</span>
<span class="sd">        tspline (boolean): Sets whether or not interpolation in time is</span>
<span class="sd">            performed using a tricubic spline or nearest-neighbor</span>
<span class="sd">            interpolation. Tricubic spline interpolation requires at least</span>
<span class="sd">            four complete equilibria at different times. It is also assumed</span>
<span class="sd">            that they are functionally correlated, and that parameters do</span>
<span class="sd">            not vary out of their boundaries (derivative = 0 boundary</span>
<span class="sd">            condition). Default is False (use nearest neighbor interpolation).</span>
<span class="sd">        monotonic (boolean): Sets whether or not the &quot;monotonic&quot; form of time</span>
<span class="sd">            window finding is used. If True, the timebase must be </span>
<span class="sd">            monotonically increasing. Default is False (use slower,</span>
<span class="sd">            safer method).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shot</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">gfile</span> <span class="o">=</span> <span class="s1">&#39;g_eqdsk&#39;</span><span class="p">,</span> <span class="n">afile</span><span class="o">=</span><span class="s1">&#39;a_eqdsk&#39;</span><span class="p">,</span> <span class="n">tspline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">monotonic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_has_MDS</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;ERROR: MDSplus module did not load properly. Exception is below:&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">_e_MDS</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EFITTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">,</span> <span class="n">tspline</span><span class="o">=</span><span class="n">tspline</span><span class="p">,</span> <span class="n">monotonic</span><span class="o">=</span><span class="n">monotonic</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_shot</span> <span class="o">=</span> <span class="n">shot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span> <span class="o">=</span> <span class="n">tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span> <span class="o">=</span> <span class="n">gfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_afile</span> <span class="o">=</span> <span class="n">afile</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span> <span class="o">=</span> <span class="n">MDSplus</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shot</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1">#initialize None for non-essential data</span>

        <span class="c1">#grad-shafranov related parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span> <span class="o">=</span> <span class="bp">None</span>                                                <span class="c1">#pressure on flux surface (psi,t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#pressure derivative on flux surface (t,psi)</span>

        <span class="c1">#fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#Bt on-axis, with plasma (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#Bt on-axis, vacuum (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#avg poloidal field (t)</span>

        <span class="c1">#plasma current</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#EFIT-calculated plasma current (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#measured plasma current (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Jp</span> <span class="o">=</span> <span class="bp">None</span>                                                      <span class="c1">#grid of current density (r,z,t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="o">=</span> <span class="bp">None</span>                                             <span class="c1">#sign of current for entire shot (calculated in moderately kludgey manner)</span>

        <span class="c1">#safety factor parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="o">=</span> <span class="bp">None</span>                                                      <span class="c1">#q on-axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="o">=</span> <span class="bp">None</span>                                                     <span class="c1">#q at 95% flux (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#q at LCFS (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="o">=</span> <span class="bp">None</span>                                                     <span class="c1">#outboard-midplane minor radius of q=1 surface (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="o">=</span> <span class="bp">None</span>                                                     <span class="c1">#outboard-midplane minor radius of q=2 surface (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="o">=</span> <span class="bp">None</span>                                                     <span class="c1">#outboard-midplane minor radius of q=3 surface (t)</span>

        <span class="c1">#shaping parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#LCFS elongation (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#LCFS upper triangularity (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#LCFS lower triangularity (t)</span>

        <span class="c1">#(dimensional) geometry parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#major radius, magnetic axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#Z magnetic axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#outboard-midplane minor radius (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                <span class="c1">#outboard-midplane major radius (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                <span class="c1">#LCFS surface area (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#R-positions of LCFS (t,n)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#Z-positions of LCFS (t,n)</span>
        
        <span class="c1">#machine geometry parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Rlimiter</span> <span class="o">=</span> <span class="bp">None</span>                                                <span class="c1">#R-positions of vacuum-vessel wall (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Zlimiter</span> <span class="o">=</span> <span class="bp">None</span>                                                <span class="c1">#Z-positions of vacuum-vessel wall (t)</span>

        <span class="c1">#calc. normalized-pressure values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT-calc toroidal beta (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT-calc avg. poloidal beta (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="o">=</span> <span class="bp">None</span>                                                      <span class="c1">#EFIT-calc internal inductance (t)</span>

        <span class="c1">#diamagnetic measurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#diamagnetic flux (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#diamagnetic toroidal beta (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#diamagnetic poloidal beta (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#diamagnetic stored energy (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="o">=</span> <span class="bp">None</span>                                               <span class="c1">#diamagnetic energy confinement time (t)</span>

        <span class="c1">#energy calculations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#EFIT-calc stored energy (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="o">=</span> <span class="bp">None</span>                                                  <span class="c1">#EFIT-calc energy confinement time (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#EFIT-calc injected power (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT d/dt magnetic stored energy (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT d/dt plasma stored energy (t)</span>

        <span class="c1">#load essential mapping data</span>
        <span class="c1"># Set the variables to None first so the loading calls will work right:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#EFIT timebase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT flux grid (r,z,t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT R-axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span> <span class="o">=</span> <span class="bp">None</span>                                                   <span class="c1">#EFIT Z-axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#flux at LCFS (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#flux at magnetic axis (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#volume within flux surface (t,psi)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#volume within LCFS (t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span> <span class="o">=</span> <span class="bp">None</span>                                                    <span class="c1">#q profile (psi,t)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span> <span class="o">=</span> <span class="bp">None</span>                                                 <span class="c1">#max major radius of flux surface (t,psi)</span>
        
        <span class="c1"># Call the get functions to preload the data. Add any other calls you</span>
        <span class="c1"># want to preload here.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getFluxGrid</span><span class="p">()</span> <span class="c1"># loads _psiRZ, _rGrid and _zGrid at once.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getFluxLCFS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getFluxAxis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getVolLCFS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getQProfile</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getRmidPsi</span><span class="p">()</span>
        
<div class="viewcode-block" id="EFITTree.__str__"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;string formatting for EFITTree class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">)</span>
            <span class="n">nr</span><span class="o">=</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span><span class="p">)</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span><span class="p">)</span>

            <span class="n">mes</span> <span class="o">=</span> <span class="s1">&#39;EFIT data for shot &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shot</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; from tree &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>\
                  <span class="s1">&#39;timebase &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;s in &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; points</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; spatial grid&#39;</span>
            <span class="k">return</span> <span class="n">mes</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;tree has failed data load.&#39;</span>
</div>
<div class="viewcode-block" id="EFITTree.getInfo"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns namedtuple of shot information</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing</span>
<span class="sd">                </span>
<span class="sd">                =====   ===============================</span>
<span class="sd">                shot    C-Mod shot index (long)</span>
<span class="sd">                tree    EFIT tree (string)</span>
<span class="sd">                nr      size of R-axis for spatial grid</span>
<span class="sd">                nz      size of Z-axis for spatial grid</span>
<span class="sd">                nt      size of timebase for flux grid</span>
<span class="sd">                =====   ===============================</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">)</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span><span class="p">)</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">nt</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">print</span> <span class="s1">&#39;tree has failed data load.&#39;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Info&#39;</span><span class="p">,[</span><span class="s1">&#39;shot&#39;</span><span class="p">,</span><span class="s1">&#39;tree&#39;</span><span class="p">,</span><span class="s1">&#39;nr&#39;</span><span class="p">,</span><span class="s1">&#39;nz&#39;</span><span class="p">,</span><span class="s1">&#39;nt&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">shot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_shot</span><span class="p">,</span><span class="n">tree</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">,</span><span class="n">nr</span><span class="o">=</span><span class="n">nr</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="n">nz</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getTimeBase"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getTimeBase">[docs]</a>    <span class="k">def</span> <span class="nf">getTimeBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT time base vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">timeNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:time&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">timeNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timeNode</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFluxGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFluxGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT flux grid, [t,z,r]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">psinode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:psirz&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">dim_of</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">dim_of</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_psiRZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">units</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rGrid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">dim_of</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">units</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_zGrid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psinode</span><span class="o">.</span><span class="n">dim_of</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getRGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getRGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getRGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT R-axis [r]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        
        <span class="c1"># Default units should be &#39;m&#39;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rGrid&#39;</span><span class="p">],</span>
                                                      <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getZGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getZGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getZGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT Z-axis [z]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        
        <span class="c1"># Default units should be &#39;m&#39;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_zGrid&#39;</span><span class="p">],</span>
                                                      <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFluxAxis"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFluxAxis">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns psi on magnetic axis [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">psiAxisNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:simagx&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span> <span class="o">=</span> <span class="n">psiAxisNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_psiAxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psiAxisNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFluxLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFluxLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns psi at separatrix [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">psiLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:sibdry&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span> <span class="o">=</span> <span class="n">psiLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_psiLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">psiLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFluxVol"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFluxVol">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxVol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns volume within flux surface [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fluxVolNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="s1">&#39;fitout:volp&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span> <span class="o">=</span> <span class="n">fluxVolNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="c1"># Units aren&#39;t properly stored in the tree for this one!</span>
                <span class="k">if</span> <span class="n">fluxVolNode</span><span class="o">.</span><span class="n">units</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_fluxVol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fluxVolNode</span><span class="o">.</span><span class="n">units</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_fluxVol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m^3&#39;</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="c1"># Default units are m^3, but aren&#39;t stored in the tree!</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_fluxVol&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getVolLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getVolLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getVolLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns volume within LCFS [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">volLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:vout&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="o">=</span> <span class="n">volLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_volLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="c1"># Default units should be &#39;cm^3&#39;:</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_volLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getRmidPsi"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getRmidPsi">[docs]</a>    <span class="k">def</span> <span class="nf">getRmidPsi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns maximum major radius of each flux surface [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">RmidPsiNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="s1">&#39;fitout:rpres&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span> <span class="o">=</span> <span class="n">RmidPsiNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="c1"># Units aren&#39;t properly stored in the tree for this one!</span>
                <span class="k">if</span> <span class="n">RmidPsiNode</span><span class="o">.</span><span class="n">units</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidPsi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RmidPsiNode</span><span class="o">.</span><span class="n">units</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidPsi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidPsi&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getRLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getRLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getRLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns R-values of LCFS position [t,n]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">RLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:rbbbs&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span> <span class="o">=</span> <span class="n">RLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getZLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getZLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getZLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns Z-values of LCFS position [t,n]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ZLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:zbbbs&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span> <span class="o">=</span> <span class="n">ZLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_ZLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_ZLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="EFITTree.remapLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.remapLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">remapLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrites RLCFS, ZLCFS values pulled from EFIT with explicitly-calculated contour</span>
<span class="sd">        of psinorm=1 surface.  This is then masked down by the limiter array using core.inPolygon,</span>
<span class="sd">        restricting the contour to the closed plasma surface and the divertor legs.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            mask: Boolean.</span>
<span class="sd">                Default False.  Set True to mask LCFS path to limiter outline (using inPolygon).</span>
<span class="sd">                Set False to draw full contour of psi = psiLCFS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_has_plt</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Requires matplotlib.pyplot for contour calculation.&quot;</span><span class="p">)</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Rlim</span><span class="p">,</span><span class="n">Zlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMachineCrossSection</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Limiter outline (self.getMachineCrossSection) must be available.&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
            
        <span class="n">psiRZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxGrid</span><span class="p">()</span>  <span class="c1"># [nt,nZ,nR]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRGrid</span><span class="p">()</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getZGrid</span><span class="p">()</span>
        <span class="n">psiLCFS</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentSign</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxLCFS</span><span class="p">()</span>

        <span class="n">RLCFS_stores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ZLCFS_stores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">maxlen</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">())</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">psiRZ</span><span class="p">[</span><span class="n">i</span><span class="p">],[</span><span class="n">psiLCFS</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()</span>
            <span class="n">RLCFS_frame</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ZLCFS_frame</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span>
                <span class="n">RLCFS_frame</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ZLCFS_frame</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RLCFS_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="n">ZLCFS_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">RLCFS_frame</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">)</span>
            <span class="n">ZLCFS_frame</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ZLCFS_frame</span><span class="p">)</span>

            <span class="c1"># generate masking array to vessel</span>
            <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
                <span class="n">maskarr</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">))])</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">):</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">ZLCFS_frame</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">maskarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inPolygon</span><span class="p">(</span><span class="n">Rlim</span><span class="p">,</span><span class="n">Zlim</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

                <span class="n">RLCFS_frame</span> <span class="o">=</span> <span class="n">RLCFS_frame</span><span class="p">[</span><span class="n">maskarr</span><span class="p">]</span>
                <span class="n">ZLCFS_frame</span> <span class="o">=</span> <span class="n">ZLCFS_frame</span><span class="p">[</span><span class="n">maskarr</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxlen</span><span class="p">:</span>
                <span class="n">maxlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">)</span>
            <span class="n">RLCFS_stores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">)</span>
            <span class="n">ZLCFS_stores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ZLCFS_frame</span><span class="p">)</span>

        <span class="n">RLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span><span class="n">maxlen</span><span class="p">))</span>
        <span class="n">ZLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span><span class="n">maxlen</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="n">RLCFS_frame</span> <span class="o">=</span> <span class="n">RLCFS_stores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">ZLCFS_frame</span> <span class="o">=</span> <span class="n">ZLCFS_stores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">ni</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RLCFS_frame</span><span class="p">)</span>
            <span class="n">RLCFS</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">ni</span><span class="p">]</span> <span class="o">=</span> <span class="n">RLCFS_frame</span>
            <span class="n">ZLCFS</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">ni</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZLCFS_frame</span>

        <span class="c1"># store final values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span> <span class="o">=</span> <span class="n">RLCFS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span> <span class="o">=</span> <span class="n">ZLCFS</span>

        <span class="c1"># set default unit parameters, based on RZ grid</span>
        <span class="n">rUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rGrid&#39;</span><span class="p">]</span>
        <span class="n">zUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_zGrid&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rUnit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_ZLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zUnit</span>

        <span class="c1"># cleanup</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getF"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getF">[docs]</a>    <span class="k">def</span> <span class="nf">getF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns F=RB_{\Phi}(\Psi), often calculated for grad-shafranov solutions  [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:fpol&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span> <span class="o">=</span> <span class="n">fNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_fpol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFluxPres"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFluxPres">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxPres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns pressure at flux surface [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fluxPresNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:pres&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span> <span class="o">=</span> <span class="n">fluxPresNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_fluxPres&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fluxPresNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFFPrime"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFFPrime">[docs]</a>    <span class="k">def</span> <span class="nf">getFFPrime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns FF&#39; function used for grad-shafranov solutions [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">FFPrimeNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:ffprim&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span> <span class="o">=</span> <span class="n">FFPrimeNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_ffprim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FFPrimeNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getPPrime"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getPPrime">[docs]</a>    <span class="k">def</span> <span class="nf">getPPrime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns plasma pressure gradient as a function of psi [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pPrimeNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:pprime&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span> <span class="o">=</span> <span class="n">pPrimeNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_pprime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pPrimeNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getElongation"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getElongation">[docs]</a>    <span class="k">def</span> <span class="nf">getElongation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns LCFS elongation [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">kappaNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:eout&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="o">=</span> <span class="n">kappaNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_kappa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kappaNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getUpperTriangularity"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getUpperTriangularity">[docs]</a>    <span class="k">def</span> <span class="nf">getUpperTriangularity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns LCFS upper triangularity [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dupperNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:doutu&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="o">=</span> <span class="n">dupperNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_dupper&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dupperNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getLowerTriangularity"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getLowerTriangularity">[docs]</a>    <span class="k">def</span> <span class="nf">getLowerTriangularity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns LCFS lower triangularity [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dlowerNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:doutl&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="o">=</span> <span class="n">dlowerNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_dlower&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dlowerNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getSlhaping"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getSlhaping">[docs]</a>    <span class="k">def</span> <span class="nf">getSlhaping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls LCFS elongation and upper/lower triangularity</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {kappa, delta_u, delta_l}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElongation</span><span class="p">()</span>
            <span class="n">du</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperTriangularity</span><span class="p">()</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerTriangularity</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Shaping&#39;</span><span class="p">,[</span><span class="s1">&#39;kappa&#39;</span><span class="p">,</span><span class="s1">&#39;delta_u&#39;</span><span class="p">,</span><span class="s1">&#39;delta_l&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kap</span><span class="p">,</span><span class="n">delta_u</span><span class="o">=</span><span class="n">du</span><span class="p">,</span><span class="n">delta_l</span><span class="o">=</span><span class="n">dl</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getMagR"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getMagR">[docs]</a>    <span class="k">def</span> <span class="nf">getMagR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns magnetic-axis major radius [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rmagNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:rmagx&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="o">=</span> <span class="n">rmagNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rmag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmagNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rmag&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getMagZ"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getMagZ">[docs]</a>    <span class="k">def</span> <span class="nf">getMagZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns magnetic-axis Z [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">zmagNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:zmagx&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="o">=</span> <span class="n">zmagNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_zmag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zmagNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_zmag&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getAreaLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getAreaLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getAreaLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns LCFS cross-sectional area [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">areaLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:areao&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="o">=</span> <span class="n">areaLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_areaLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">areaLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="c1"># Units should be cm^2:</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_areaLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getAOut"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getAOut">[docs]</a>    <span class="k">def</span> <span class="nf">getAOut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns outboard-midplane minor radius at LCFS [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">aLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:aout&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="o">=</span> <span class="n">aLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_aLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_aLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getRmidOut"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getRmidOut">[docs]</a>    <span class="k">def</span> <span class="nf">getRmidOut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns outboard-midplane major radius [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">RmidLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:rmidout&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="o">=</span> <span class="n">RmidLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="c1"># The units aren&#39;t properly stored in the tree for this one!</span>
                <span class="c1"># Should be meters.</span>
                <span class="k">if</span> <span class="n">RmidLCFSNode</span><span class="o">.</span><span class="n">units</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RmidLCFSNode</span><span class="o">.</span><span class="n">units</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_RmidLCFS&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getGeometry"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">getGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls dimensional geometry parameters</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {magnetic-axis R,Z, LCFS area, outboard-midplane LCFS a,R}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Rmag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMagR</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">Zmag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMagZ</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">AreaLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAreaLCFS</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">aOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAOut</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">RmidOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRmidOut</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Geometry&#39;</span><span class="p">,[</span><span class="s1">&#39;Rmag&#39;</span><span class="p">,</span><span class="s1">&#39;Zmag&#39;</span><span class="p">,</span><span class="s1">&#39;AreaLCFS&#39;</span><span class="p">,</span><span class="s1">&#39;aOut&#39;</span><span class="p">,</span><span class="s1">&#39;RmidOut&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">Rmag</span><span class="o">=</span><span class="n">Rmag</span><span class="p">,</span><span class="n">Zmag</span><span class="o">=</span><span class="n">Zmag</span><span class="p">,</span><span class="n">AreaLCFS</span><span class="o">=</span><span class="n">AreaLCFS</span><span class="p">,</span><span class="n">aOut</span><span class="o">=</span><span class="n">aOut</span><span class="p">,</span><span class="n">RmidOut</span><span class="o">=</span><span class="n">RmidOut</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getQProfile"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQProfile">[docs]</a>    <span class="k">def</span> <span class="nf">getQProfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns safety factor q [t,psi]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">qpsiNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:qpsi&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span> <span class="o">=</span> <span class="n">qpsiNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_qpsi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qpsiNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQ0"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQ0">[docs]</a>    <span class="k">def</span> <span class="nf">getQ0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns q on magnetic axis [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">q0Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:qqmagx&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="o">=</span> <span class="n">q0Node</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_q0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q0Node</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQ95"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQ95">[docs]</a>    <span class="k">def</span> <span class="nf">getQ95</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns q at 95% flux surface [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">q95Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:qpsib&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="o">=</span> <span class="n">q95Node</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_q95&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q95Node</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getQLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns q on LCFS [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">qLCFSNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:qout&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="o">=</span> <span class="n">qLCFSNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_qLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qLCFSNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQ1Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQ1Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ1Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns outboard-midplane minor radius of q=1 surface [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rq1Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:aaq1&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="o">=</span> <span class="n">rq1Node</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rq1Node</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq1&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQ2Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQ2Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ2Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns outboard-midplane minor radius of q=2 surface [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rq2Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:aaq2&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="o">=</span> <span class="n">rq2Node</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rq2Node</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq2&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQ3Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQ3Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ3Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns outboard-midplane minor radius of q=3 surface [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rq3Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:aaq3&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="o">=</span> <span class="n">rq3Node</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rq3Node</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_rq3&#39;</span><span class="p">],</span> <span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getQs"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getQs">[docs]</a>    <span class="k">def</span> <span class="nf">getQs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls q values</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {q0,q95,qLCFS,rq1,rq2,rq3}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ0</span><span class="p">()</span>
            <span class="n">q95</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ95</span><span class="p">()</span>
            <span class="n">qLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQLCFS</span><span class="p">()</span>
            <span class="n">rq1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ1Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">rq2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ2Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">rq3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ3Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Qs&#39;</span><span class="p">,[</span><span class="s1">&#39;q0&#39;</span><span class="p">,</span><span class="s1">&#39;q95&#39;</span><span class="p">,</span><span class="s1">&#39;qLCFS&#39;</span><span class="p">,</span><span class="s1">&#39;rq1&#39;</span><span class="p">,</span><span class="s1">&#39;rq2&#39;</span><span class="p">,</span><span class="s1">&#39;rq3&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">q0</span><span class="o">=</span><span class="n">q0</span><span class="p">,</span><span class="n">q95</span><span class="o">=</span><span class="n">q95</span><span class="p">,</span><span class="n">qLCFS</span><span class="o">=</span><span class="n">qLCFS</span><span class="p">,</span><span class="n">rq1</span><span class="o">=</span><span class="n">rq1</span><span class="p">,</span><span class="n">rq2</span><span class="o">=</span><span class="n">rq2</span><span class="p">,</span><span class="n">rq3</span><span class="o">=</span><span class="n">rq3</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getBtVac"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBtVac">[docs]</a>    <span class="k">def</span> <span class="nf">getBtVac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns on-axis vacuum toroidal field [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">btaxvNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:btaxv&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="o">=</span> <span class="n">btaxvNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_btaxv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btaxvNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getBtPla"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBtPla">[docs]</a>    <span class="k">def</span> <span class="nf">getBtPla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns on-axis plasma toroidal field [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">btaxpNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:btaxp&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="o">=</span> <span class="n">btaxpNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_btaxp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btaxpNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getBpAvg"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBpAvg">[docs]</a>    <span class="k">def</span> <span class="nf">getBpAvg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns average poloidal field [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bpolavNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:bpolav&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="o">=</span> <span class="n">bpolavNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_bpolav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bpolavNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getFields"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getFields">[docs]</a>    <span class="k">def</span> <span class="nf">getFields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls vacuum and plasma toroidal field, avg poloidal field</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {btaxv,btaxp,bpolav}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">btaxv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBtVac</span><span class="p">()</span>
            <span class="n">btaxp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBtPla</span><span class="p">()</span>
            <span class="n">bpolav</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBpAvg</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Fields&#39;</span><span class="p">,[</span><span class="s1">&#39;BtVac&#39;</span><span class="p">,</span><span class="s1">&#39;BtPla&#39;</span><span class="p">,</span><span class="s1">&#39;BpAvg&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">BtVac</span><span class="o">=</span><span class="n">btaxv</span><span class="p">,</span><span class="n">BtPla</span><span class="o">=</span><span class="n">btaxp</span><span class="p">,</span><span class="n">BpAvg</span><span class="o">=</span><span class="n">bpolav</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getIpCalc"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getIpCalc">[docs]</a>    <span class="k">def</span> <span class="nf">getIpCalc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated plasma current [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">IpCalcNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:cpasma&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span> <span class="o">=</span> <span class="n">IpCalcNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_IpCalc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IpCalcNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getIpMeas"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getIpMeas">[docs]</a>    <span class="k">def</span> <span class="nf">getIpMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns magnetics-measured plasma current [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">IpMeasNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:pasmat&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="o">=</span> <span class="n">IpMeasNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_IpMeas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IpMeasNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getJp"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getJp">[docs]</a>    <span class="k">def</span> <span class="nf">getJp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated plasma current density Jp on flux grid [t,r,z]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Jp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">JpNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:pcurrt&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Jp</span> <span class="o">=</span> <span class="n">JpNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="c1"># Units come in as &#39;a&#39;: am I missing something about the</span>
                <span class="c1"># definition of this quantity?</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_Jp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">JpNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Jp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getBetaT"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBetaT">[docs]</a>    <span class="k">def</span> <span class="nf">getBetaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated toroidal beta [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">betatNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:betat&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="o">=</span> <span class="n">betatNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_betat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">betatNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getBetaP"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBetaP">[docs]</a>    <span class="k">def</span> <span class="nf">getBetaP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated poloidal beta [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">betapNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:betap&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="o">=</span> <span class="n">betapNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_betap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">betapNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getLi"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getLi">[docs]</a>    <span class="k">def</span> <span class="nf">getLi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated internal inductance [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">LiNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:ali&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="o">=</span> <span class="n">LiNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_Li&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LiNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getBetas"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getBetas">[docs]</a>    <span class="k">def</span> <span class="nf">getBetas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls calculated betap, betat, internal inductance</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {betat,betap,Li}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">betat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBetaT</span><span class="p">()</span>
            <span class="n">betap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBetaP</span><span class="p">()</span>
            <span class="n">Li</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLi</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Betas&#39;</span><span class="p">,[</span><span class="s1">&#39;betat&#39;</span><span class="p">,</span><span class="s1">&#39;betap&#39;</span><span class="p">,</span><span class="s1">&#39;Li&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">betat</span><span class="o">=</span><span class="n">betat</span><span class="p">,</span><span class="n">betap</span><span class="o">=</span><span class="n">betap</span><span class="p">,</span><span class="n">Li</span><span class="o">=</span><span class="n">Li</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamagFlux"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamagFlux">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagFlux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns measured diamagnetic-loop flux [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">diamagNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:diamag&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="o">=</span> <span class="n">diamagNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_diamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diamagNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamagBetaT"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamagBetaT">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagBetaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns diamagnetic-loop toroidal beta [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">betatdNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:betatd&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="o">=</span> <span class="n">betatdNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_betatd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">betatdNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamagBetaP"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamagBetaP">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagBetaP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns diamagnetic-loop avg poloidal beta [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">betapdNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:betapd&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="o">=</span> <span class="n">betapdNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_betapd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">betapdNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamagTauE"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamagTauE">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagTauE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns diamagnetic-loop energy confinement time [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tauDiamagNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:taudia&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="o">=</span> <span class="n">tauDiamagNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_tauDiamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tauDiamagNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamagWp"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamagWp">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagWp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns diamagnetic-loop plasma stored energy [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WDiamagNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:wplasmd&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="o">=</span> <span class="n">WDiamagNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_WDiamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WDiamagNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getDiamag"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getDiamag">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls diamagnetic flux measurements, toroidal and poloidal beta, energy confinement time and stored energy</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {diamag. flux, betatd, betapd, tauDiamag, WDiamag}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dFlux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagFlux</span><span class="p">()</span>
            <span class="n">betatd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagBetaT</span><span class="p">()</span>
            <span class="n">betapd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagBetaP</span><span class="p">()</span>
            <span class="n">dTau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagTauE</span><span class="p">()</span>
            <span class="n">dWp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagWp</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Diamag&#39;</span><span class="p">,[</span><span class="s1">&#39;diaFlux&#39;</span><span class="p">,</span><span class="s1">&#39;diaBetat&#39;</span><span class="p">,</span><span class="s1">&#39;diaBetap&#39;</span><span class="p">,</span><span class="s1">&#39;diaTauE&#39;</span><span class="p">,</span><span class="s1">&#39;diaWp&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">diaFlux</span><span class="o">=</span><span class="n">dFlux</span><span class="p">,</span><span class="n">diaBetat</span><span class="o">=</span><span class="n">betatd</span><span class="p">,</span><span class="n">diaBetap</span><span class="o">=</span><span class="n">betapd</span><span class="p">,</span><span class="n">diaTauE</span><span class="o">=</span><span class="n">dTau</span><span class="p">,</span><span class="n">diaWp</span><span class="o">=</span><span class="n">dWp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getWMHD"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getWMHD">[docs]</a>    <span class="k">def</span> <span class="nf">getWMHD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated MHD stored energy [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WMHDNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:wplasm&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="o">=</span> <span class="n">WMHDNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_WMHD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WMHDNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getTauMHD"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getTauMHD">[docs]</a>    <span class="k">def</span> <span class="nf">getTauMHD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated MHD energy confinement time [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tauMHDNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:taumhd&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="o">=</span> <span class="n">tauMHDNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_tauMHD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tauMHDNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getPinj"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getPinj">[docs]</a>    <span class="k">def</span> <span class="nf">getPinj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated injected power [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">PinjNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:pbinj&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="o">=</span> <span class="n">PinjNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_Pinj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PinjNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getWbdot"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getWbdot">[docs]</a>    <span class="k">def</span> <span class="nf">getWbdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated d/dt of magnetic stored energy [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WbdotNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:wbdot&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="o">=</span> <span class="n">WbdotNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_Wbdot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WbdotNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getWpdot"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getWpdot">[docs]</a>    <span class="k">def</span> <span class="nf">getWpdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns EFIT-calculated d/dt of plasma stored energy [t]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WpdotNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afile</span><span class="o">+</span><span class="s1">&#39;:wpdot&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="o">=</span> <span class="n">WpdotNode</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s1">&#39;_Wpdot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WpdotNode</span><span class="o">.</span><span class="n">units</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EFITTree.getEnergy"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;pulls EFIT-calculated energy parameters - stored energy, tau_E, injected power, d/dt of magnetic and plasma stored energy</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            namedtuple containing {WMHD,tauMHD,Pinj,Wbdot,Wpdot}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WMHD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWMHD</span><span class="p">()</span>
            <span class="n">tauMHD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTauMHD</span><span class="p">()</span>
            <span class="n">Pinj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPinj</span><span class="p">()</span>
            <span class="n">Wbdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWbdot</span><span class="p">()</span>
            <span class="n">Wpdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWpdot</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">,[</span><span class="s1">&#39;WMHD&#39;</span><span class="p">,</span><span class="s1">&#39;tauMHD&#39;</span><span class="p">,</span><span class="s1">&#39;Pinj&#39;</span><span class="p">,</span><span class="s1">&#39;Wbdot&#39;</span><span class="p">,</span><span class="s1">&#39;Wpdot&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">WMHD</span><span class="o">=</span><span class="n">WMHD</span><span class="p">,</span><span class="n">tauMHD</span><span class="o">=</span><span class="n">tauMHD</span><span class="p">,</span><span class="n">Pinj</span><span class="o">=</span><span class="n">Pinj</span><span class="p">,</span><span class="n">Wbdot</span><span class="o">=</span><span class="n">Wbdot</span><span class="p">,</span><span class="n">Wpdot</span><span class="o">=</span><span class="n">Wpdot</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data retrieval failed.&#39;</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="EFITTree.getMachineCrossSection"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getMachineCrossSection">[docs]</a>    <span class="k">def</span> <span class="nf">getMachineCrossSection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns R,Z coordinates of vacuum-vessel wall for masking, plotting routines.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            The requested data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Rlimiter</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Zlimiter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">limitr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:limitr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:xlim&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfile</span><span class="o">+</span><span class="s1">&#39;:ylim&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                <span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">npts</span> <span class="o">&lt;</span> <span class="n">limitr</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dimensions inconsistent in limiter array lengths.&quot;</span><span class="p">)</span>
                    
                <span class="bp">self</span><span class="o">.</span><span class="n">_Rlimiter</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">limitr</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Zlimiter</span> <span class="o">=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">limitr</span><span class="p">]</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">TreeException</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data retrieval failed.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Rlimiter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_Zlimiter</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getMachineCrossSectionFull"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getMachineCrossSectionFull">[docs]</a>    <span class="k">def</span> <span class="nf">getMachineCrossSectionFull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns R,Z coordinates of vacuum-vessel wall for plotting routines.</span>
<span class="sd">        </span>
<span class="sd">        Absent additional vector-graphic data on machine cross-section, returns</span>
<span class="sd">        self.getMachineCrossSection().</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            The requested data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMachineCrossSection</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;self.getMachineCrossSection not implemented.&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EFITTree.getCurrentSign"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getCurrentSign">[docs]</a>    <span class="k">def</span> <span class="nf">getCurrentSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the sign of the current, based on the check in Steve Wolfe&#39;s IDL implementation efit_rz2psi.pro.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">scipy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getIpMeas</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mf">1e5</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span>
</div>
<div class="viewcode-block" id="EFITTree.getParam"><a class="viewcode-back" href="../../eqtools.html#eqtools.EFIT.EFITTree.getParam">[docs]</a>    <span class="k">def</span> <span class="nf">getParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;backup function - path to parameter as input, returns desired variable acts as wrapper for MDS call</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            path (string): The path to the MDSplus node you wish to pull in.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            The requested data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">EFITpath</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">EFITpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">+</span><span class="n">path</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MDSTree</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="n">EFITpath</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">var</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid MDS tree.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TreeException</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;path &#39;</span><span class="o">+</span><span class="n">EFITpath</span><span class="o">+</span><span class="s1">&#39; is not valid.&#39;</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">eqtools 1.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Mark Chilenski, Ian Faust and John Walk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>