

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>eqtools.eqdskreader &mdash; eqtools 0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="eqtools 0.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../index.html">eqtools 0.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for eqtools.eqdskreader</h1><div class="highlight"><pre>
<span class="c"># This program is distributed under the terms of the GNU General Purpose License (GPL).</span>
<span class="c"># Refer to http://www.gnu.org/licenses/gpl.txt</span>
<span class="c">#</span>
<span class="c"># This file is part of EqTools.</span>
<span class="c">#</span>
<span class="c"># EqTools is free software: you can redistribute it and/or modify</span>
<span class="c"># it under the terms of the GNU General Public License as published by</span>
<span class="c"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c"># (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># EqTools is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with EqTools.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the EqdskReader class, which creates Equilibrium class</span>
<span class="sd">functionality for equilibria stored in eqdsk files from EFIT(a- and g-files).</span>

<span class="sd">Classes:</span>
<span class="sd">    EqdskReader: class inheriting Equilibrium reading g- and a-files for</span>
<span class="sd">        equilibrium data.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">core</span> <span class="kn">import</span> <span class="n">Equilibrium</span>
<span class="kn">from</span> <span class="nn">afilereader</span> <span class="kn">import</span> <span class="n">AFileReader</span>


<div class="viewcode-block" id="EqdskReader"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader">[docs]</a><span class="k">class</span> <span class="nc">EqdskReader</span><span class="p">(</span><span class="n">Equilibrium</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equilibrium subclass working from eqdsk ASCII-file equilibria.</span>

<span class="sd">    Inherits mapping and structural data from Equilibrium, populates equilibrium</span>
<span class="sd">    and profile data from g- and a-files for a selected shot and time window.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">shot</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">gfile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">afile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="s">&#39;m&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create instance of EqdskReader.</span>

<span class="sd">        Generates object and reads data from selected g-file (either manually set or</span>
<span class="sd">        autodetected based on user shot and time selection), storing as object</span>
<span class="sd">        attributes for usage in Equilibrium mapping methods.</span>

<span class="sd">        Calling structure - user may call class with shot and time (ms) values, set by keywords</span>
<span class="sd">        (or positional placement allows calling without explicit keyword syntax).  EqdskReader</span>
<span class="sd">        then attempts to construct filenames from the shot/time, of the form &#39;g[shot].[time]&#39; and</span>
<span class="sd">        &#39;a[shot].[time]&#39;.  Alternately, the user may skip this input and explicitly set paths to</span>
<span class="sd">        the g- and/or a-files, using the gfile and afile keyword arguments.  If both types of calls</span>
<span class="sd">        are set, the explicit g-file and a-file paths override the auto-generated filenames from</span>
<span class="sd">        the shot and time.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            shot: Int.  Shot index.</span>
<span class="sd">            time: Int.  Time index (typically ms).  Shot and Time used to autogenerate filenames.</span>
<span class="sd">            gfile: String.  Manually selects ASCII file for equilibrium read.</span>
<span class="sd">            afile: String.  Manually selects ASCII file for time-history read.</span>
<span class="sd">            length_unit: String.  Flag setting length unit for equilibrium scales.</span>
<span class="sd">                Defaults to &#39;m&#39; for lengths in meters.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: if both name/shot and explicit filenames are not set.</span>
<span class="sd">            ValueError: if the g-file cannot be found, or if multiple valid g/a-files are found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># instantiate superclass, forcing time splining to false (eqdsk only contains single time slice)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">,</span><span class="n">tspline</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># dict to store default units of length-scale parameters, used by core._getLengthConversionFactor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># parse shot and time inputs into standard naming convention</span>
        <span class="k">if</span> <span class="n">shot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">timestring</span> <span class="o">=</span> <span class="s">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">timestring</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">)[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Time window string greater than 5 digits.  Masking to last 5 digits. &quot;</span>
                              <span class="s">&quot;If this does not match the selected EQ files, &quot;</span>
                              <span class="s">&quot;please use explicit filename inputs.&quot;</span><span class="p">,</span>
                              <span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c">#exactly five digits</span>
                <span class="n">timestring</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">shot</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">+</span><span class="n">timestring</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">gfile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">&#39;must specify shot/time or filenames.&#39;</span><span class="p">)</span>

        <span class="c"># if explicit filename for g-file is not set, check current directory for files matching name</span>
        <span class="c"># if multiple valid files or no files are found, trigger ValueError</span>
        <span class="k">if</span> <span class="n">gfile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>   <span class="c">#attempt to generate filename</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Searching directory for file g</span><span class="si">%s</span><span class="s">.&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">gcurrfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gcurrfiles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span> <span class="o">=</span> <span class="n">gcurrfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;File found: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">gcurrfiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Multiple valid g-files detected in directory. &quot;</span>
                                  <span class="s">&quot;Please select a file with explicit &quot;</span>
                                  <span class="s">&quot;input or clean directory.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c"># no files found</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No valid g-files detected in directory. &quot;</span>
                                  <span class="s">&quot;Please select a file with explicit input or &quot;</span>
                                  <span class="s">&quot;ensure file is in directory.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c"># check that given file is in directory</span>
            <span class="n">gcurrfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">gfile</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gcurrfiles</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No g-file with the given name detected in directory. &quot;</span>
                                  <span class="s">&quot;Please ensure the file is in the active directory or &quot;</span>
                                  <span class="s">&quot;that you have supplied the correct name.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span> <span class="o">=</span> <span class="n">gfile</span>

        <span class="c"># and likewise for a-file name.  However, we can operate at reduced capacity</span>
        <span class="c"># without the a-file.  If no file with explicitly-input name is found, or </span>
        <span class="c"># multiple valid files (with no explicit input) are found, raise ValueError.</span>
        <span class="c"># otherwise (no autogenerated files found) set hasafile flag false and </span>
        <span class="c"># nonfatally warn user.</span>
        <span class="k">if</span> <span class="n">afile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;Searching directory for file a</span><span class="si">%s</span><span class="s">.&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">acurrfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;*&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">acurrfiles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span> <span class="o">=</span> <span class="n">acurrfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;File found: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">acurrfiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Multiple valid a-files detected in directory. &quot;</span>
                                  <span class="s">&quot;Please select a file with explicit &quot;</span>
                                  <span class="s">&quot;input or clean directory.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>   <span class="c"># no files found</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;No valid a-files detected in directory. &quot;</span>
                                  <span class="s">&quot;Please select a file with explicit input or &quot;</span>
                                  <span class="s">&quot;ensure file in in directory.&quot;</span><span class="p">,</span>
                                  <span class="ne">RuntimeWarning</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c"># name and afile both are not specified</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c"># check that given file is in directory</span>
            <span class="n">acurrfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">afile</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">acurrfiles</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No a-file with the given name detected in directory. &quot;</span>
                                 <span class="s">&quot;Please ensure the file is in the active directory or &quot;</span>
                                 <span class="s">&quot;that you have supplied the correct name.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span> <span class="o">=</span> <span class="n">afile</span>

        <span class="c"># now we start reading the g-file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gfile</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">gfile</span><span class="p">)</span>  <span class="c"># skip the CSV delimiter, let split or regexs handle parsing.</span>
                                        <span class="c"># use csv package for error handling.</span>
            <span class="c"># read the header line, containing grid size, mfit size, and type data</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_date</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                            <span class="c"># (str) date of g-file generation, MM/DD/YYYY</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;\D&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>   <span class="c"># (int) shot index</span>
            <span class="n">timestring</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>                           <span class="c"># (str) time index, with units (e.g. &#39;875ms&#39;)</span>
            <span class="c">#imfit = int(line[-3])                           # not sure what this is supposed to be...</span>
            <span class="n">nw</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>                              <span class="c"># width of flux grid (dim(R))</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>                              <span class="c"># height of flux grid (dim(Z))</span>

            <span class="c">#extract time, units from timestring</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;\d+&#39;</span><span class="p">,</span><span class="n">timestring</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tunits</span> <span class="o">=</span> <span class="n">timestring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">time</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">timeConvertDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;ms&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="s">&#39;s&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">*</span><span class="n">timeConvertDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_tunits</span><span class="p">]])</span> <span class="c"># returns time in seconds as array</span>
            
            <span class="c"># next line - construction values for RZ grid</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>     <span class="c"># regex magic!</span>
            <span class="n">xdim</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>     <span class="c"># width of R-axis in grid</span>
            <span class="n">zdim</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>     <span class="c"># height of Z-axis in grid</span>
            <span class="c">#rzero = float(line[2])    # zero point of R grid</span>
            <span class="n">rgrid0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>   <span class="c"># start point of R grid</span>
            <span class="n">zmid</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>     <span class="c"># midpoint of Z grid</span>

            <span class="c"># construct EFIT grid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rgrid0</span><span class="p">,</span><span class="n">rgrid0</span> <span class="o">+</span> <span class="n">xdim</span><span class="p">,</span><span class="n">nw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">zmid</span> <span class="o">-</span> <span class="n">zdim</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">zmid</span> <span class="o">+</span> <span class="n">zdim</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">nh</span><span class="p">)</span>
            <span class="c">#drefit = (self._rGrid[-1] - self._rGrid[0])/(nw-1)</span>
            <span class="c">#dzefit = (self._zGrid[-1] - self._zGrid[0])/(nh-1)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rGrid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_zGrid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>

            <span class="c"># read R,Z of magnetic axis, psi at magnetic axis and LCFS, and bzero</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rmaxis</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zmaxis</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bzero</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_psiAxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Wb/rad&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_psiLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Wb/rad&#39;</span>

            <span class="c"># read EFIT-calculated plasma current, psi at magnetic axis (duplicate), </span>
            <span class="c"># dummy, R of magnetic axis (duplicate), dummy</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_IpCalc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;A&#39;</span>

            <span class="c"># read Z of magnetic axis (duplicate), dummy, psi at LCFS (duplicate), dummy, dummy</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c"># don&#39;t actually need anything from this line</span>

            <span class="c"># start reading fpol, next nw inputs</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="n">nw</span><span class="o">/</span><span class="mi">5</span>
            <span class="k">if</span> <span class="n">nw</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>     <span class="c"># catch truncated rows</span>
                <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fpol</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

            <span class="c"># and likewise for pressure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_fluxPres&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Pa&#39;</span>

            <span class="c"># geqdsk written as negative for positive plasma current</span>
            <span class="c"># ffprim, pprime input with correct EFIT sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ffprim</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pprime</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

            <span class="c"># read the 2d [nw,nh] array for psiRZ</span>
            <span class="c"># start by reading nw x nh points into 1D array,</span>
            <span class="c"># then repack in column order into final array</span>
            <span class="n">npts</span> <span class="o">=</span> <span class="n">nw</span><span class="o">*</span><span class="n">nh</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="n">npts</span><span class="o">/</span><span class="mi">5</span>
            <span class="k">if</span> <span class="n">npts</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">psis</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">psis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psis</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">nh</span><span class="p">,</span><span class="n">nw</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_psiRZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Wb/rad&#39;</span>

            <span class="c"># read q(psi) profile, nw points (same basis as fpol, pres, etc.)</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="n">nw</span><span class="o">/</span><span class="mi">5</span>
            <span class="k">if</span> <span class="n">nw</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

            <span class="c"># read nbbbs, limitr</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">nbbbs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">limitr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c"># next data reads as 2 x nbbbs array, then broken into</span>
            <span class="c"># rbbbs, zbbbs (R,Z locations of LCFS)</span>
            <span class="n">npts</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nbbbs</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="n">npts</span><span class="o">/</span><span class="mi">5</span>
            <span class="k">if</span> <span class="n">npts</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">bbbs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">bbbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="n">bbbs</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bbbs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nbbbs</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span> <span class="o">=</span> <span class="n">bbbs</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nbbbs</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span> <span class="o">=</span> <span class="n">bbbs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nbbbs</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_RLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_ZLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>

            <span class="c"># next data reads as 2 x limitr array, then broken into</span>
            <span class="c"># xlim, ylim (locations of limiter)(?)</span>
            <span class="n">npts</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">limitr</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="n">npts</span><span class="o">/</span><span class="mi">5</span>
            <span class="k">if</span> <span class="n">npts</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d\.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">lim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">limitr</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xlim</span> <span class="o">=</span> <span class="n">lim</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ylim</span> <span class="o">=</span> <span class="n">lim</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>

            <span class="c"># this is the extent of the original g-file read.</span>
            <span class="c"># attempt to continue read for newer g-files; exception</span>
            <span class="c"># handler sets relevant parameters to None for older g-files</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># read kvtor, rvtor, nmass</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">kvtor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c">#rvtor = float(line[1])</span>
                <span class="n">nmass</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="c"># read kvtor data if present</span>
                <span class="k">if</span> <span class="n">kvtor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">nrows</span> <span class="o">=</span> <span class="n">nw</span><span class="o">/</span><span class="mi">5</span>
                    <span class="k">if</span> <span class="n">nw</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_presw</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_presw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_presw</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_presw</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_presw</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>

                <span class="c"># read ion mass density if present</span>
                <span class="k">if</span> <span class="n">nmass</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">nrows</span> <span class="o">=</span> <span class="n">nw</span><span class="o">/</span><span class="mi">5</span>
                    <span class="k">if</span> <span class="n">nw</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>

                <span class="c"># read rhovn</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="n">nw</span><span class="o">/</span><span class="mi">5</span>
                <span class="k">if</span> <span class="n">nw</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rhovn</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_rhovn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rhovn</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rhovn</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

                <span class="c"># read keecur; if &gt;0 read workk</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">gfile</span><span class="o">.</span><span class="n">readline</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">keecur</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">keecur</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_workk</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;-?\d.\d*E[-+]\d*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_workk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_workk</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_workk</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nw</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_workk</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_presw</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_preswp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rhovn</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dmion</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_workk</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>

            <span class="c"># read through to end of file to get footer line</span>
            <span class="n">r</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_efittype</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            

        <span class="c"># toroidal current density on (r,z,t) grid typically not</span>
        <span class="c"># written to g-files.  Override getter method and initialize</span>
        <span class="c"># to none.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Jp</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># initialize current direction, used by mapping routines.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># initialize data stored in a-file</span>
        <span class="c"># fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_btaxp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_btaxv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_bpolav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span>

        <span class="c"># currents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_IpMeas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;A&#39;</span>

        <span class="c"># safety factor parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>

        <span class="c"># shaping parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># dimensional geometry parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rmag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_zmag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_aLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_areaLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm^2&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_RmidLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>

        <span class="c"># calc. normalized pressure values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># diamagnetic measurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_diamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Vs&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;WDiamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;J&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_tauDiamag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;ms&#39;</span>

        <span class="c"># calculated energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_WMHD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;J&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_tauMHD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;ms&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_Pinj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;W&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_Wbdot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;W&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_Wpdot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;W&#39;</span>

        <span class="c"># fitting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_volLCFS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;cm^3&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_fluxVol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m^3&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_RmidPsi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>

        <span class="c"># attempt to populate these parameters from a-file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">readAFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_afilename</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;a-file data not loaded.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;a-file data not loaded.&#39;</span><span class="p">)</span>
                    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_efittype</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="s">&#39;equilibrium&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_efittype</span><span class="o">+</span><span class="s">&#39; equilibrium&#39;</span>
        <span class="k">return</span> <span class="s">&#39;G-file &#39;</span><span class="o">+</span><span class="n">eq</span><span class="o">+</span><span class="s">&#39; from &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span><span class="p">)</span>
        
<div class="viewcode-block" id="EqdskReader.getInfo"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns namedtuple of equilibrium information</span>
<span class="sd">        outputs:</span>
<span class="sd">        namedtuple containing</span>
<span class="sd">            shot:       shot index</span>
<span class="sd">            time:       time point of g-file</span>
<span class="sd">            nr:         size of R-axis of spatial grid</span>
<span class="sd">            nz:         size of Z-axis of spatial grid</span>
<span class="sd">            efittype:   EFIT calculation type (magnetic, kinetic, MSE)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Info&#39;</span><span class="p">,[</span><span class="s">&#39;shot&#39;</span><span class="p">,</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="s">&#39;nr&#39;</span><span class="p">,</span><span class="s">&#39;nz&#39;</span><span class="p">,</span><span class="s">&#39;efittype&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span><span class="p">)</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span><span class="p">)</span>
            <span class="n">shot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shot</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
            <span class="n">efittype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_efittype</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">nr</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">shot</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">efittype</span><span class="o">=</span><span class="bp">None</span>
            <span class="k">print</span> <span class="s">&#39;failed to load data from g-file.&#39;</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">shot</span><span class="o">=</span><span class="n">shot</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">nr</span><span class="o">=</span><span class="n">nr</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="n">nz</span><span class="p">,</span><span class="n">efittype</span><span class="o">=</span><span class="n">efittype</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.readAFile"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.readAFile">[docs]</a>    <span class="k">def</span> <span class="nf">readAFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">afile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a-file (scalar time-history data) to pull additional equilibrium data</span>
<span class="sd">        not found in g-file, populates remaining data (initialized as None) in object.</span>

<span class="sd">        Args:</span>
<span class="sd">            afile: String.  Path to ASCII a-file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IOError: If afile is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">afr</span> <span class="o">=</span> <span class="n">AFileReader</span><span class="p">(</span><span class="n">afile</span><span class="p">)</span>

            <span class="c"># fields</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">btaxp</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">btaxv</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">bpolav</span><span class="p">])</span>

            <span class="c"># currents</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">pasmat</span><span class="p">])</span>

            <span class="c"># safety factor parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">qqmin</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">qpsib</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">qout</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">aaq1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">aaq2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">aaq3</span><span class="p">])</span>

            <span class="c"># shaping parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">eout</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">doutu</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">doutl</span><span class="p">])</span>

            <span class="c"># dimensional geometry parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">rmagx</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">zmagx</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">aout</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">areao</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">rmidout</span><span class="p">])</span>

            <span class="c"># calc. normalized pressure values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">betat</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">betap</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">ali</span><span class="p">])</span>

            <span class="c"># diamagnetic measurements</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">diamag</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">betatd</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">betapd</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">wplasmd</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">taudia</span><span class="p">])</span>

            <span class="c"># calculated energy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">wplasm</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">taumhd</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">pbinj</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">wbdot</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">wpdot</span><span class="p">])</span>

            <span class="c"># fitting parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">afr</span><span class="o">.</span><span class="n">vout</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fluxVol</span> <span class="o">=</span> <span class="bp">None</span>    <span class="c"># not written in g- or a-file; disable volnorm mapping routine</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_RmidPsi</span> <span class="o">=</span> <span class="bp">None</span>    <span class="c"># not written in g- or a-file, not used by fitting parameters</span>

        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">&#39;no file &quot;</span><span class="si">%s</span><span class="s">&quot; found.&#39;</span> <span class="o">%</span> <span class="n">afile</span><span class="p">)</span>

    <span class="c">####################################################</span>
    <span class="c"># wrappers for mapping routines handling time call #</span>
    <span class="c">####################################################</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2psi"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2psi">[docs]</a>    <span class="k">def</span> <span class="nf">rz2psi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts passed, R,Z arrays to psi values.</span>
<span class="sd">        Wrapper for Equilibrium.rz2psi masking out timebase dependence.</span>

<span class="sd">        Args:</span>
<span class="sd">            R: Array-like or scalar float. Values of the radial coordinate to</span>
<span class="sd">                map to poloidal flux. If the make_grid keyword is True, R must </span>
<span class="sd">                have shape (len_R,).</span>
<span class="sd">            Z: Array-like or scalar float. Values of the vertical coordinate to</span>
<span class="sd">                map to poloidal flux. Must have the same shape as R unless the </span>
<span class="sd">                make_grid keyword is set. If the make_grid keyword is True, Z </span>
<span class="sd">                must have shape (len_Z,).</span>
<span class="sd">            *args: slot for time input for consistent syntax with Equilibrium.rz2psi.</span>
<span class="sd">                will return dummy value for time if input in EqdskReader.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            make_grid: Boolean. Set to True to pass R and Z through meshgrid</span>
<span class="sd">                before evaluating. If this is set to True, R and Z must each</span>
<span class="sd">                only have a single dimension, but can have different lengths.</span>
<span class="sd">                Default is False (do not form meshgrid).</span>
<span class="sd">            length_unit: String or 1. Length unit that R and Z are being given</span>
<span class="sd">                in. If a string is given, it must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R and Z given in meters).</span>
<span class="sd">            **kwargs: other keywords (i.e., return_t) to rz2psi are valid</span>
<span class="sd">                (necessary for proper inheritance and usage in other mapping routines)</span>
<span class="sd">                but will return dummy values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            psi: Array or scalar float. If all of the input arguments are scalar,</span>
<span class="sd">                then a scalar is returned. Otherwise, a scipy Array instance is</span>
<span class="sd">                returned. If R and Z both have the same shape then psi has this</span>
<span class="sd">                shape as well. If the make_grid keyword was True then psi has</span>
<span class="sd">                shape (len(Z), len(R)).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rz2psi</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2psinorm"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2psinorm">[docs]</a>    <span class="k">def</span> <span class="nf">rz2psinorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the normalized poloidal flux at the given (R,Z).</span>
<span class="sd">        Wrapper for Equilibrium.rz2psinorm masking out timebase dependence.</span>

<span class="sd">        Uses the definition:</span>
<span class="sd">        psi_norm = (psi - psi(0)) / (psi(a) - psi(0))</span>

<span class="sd">        Args:</span>
<span class="sd">            R: Array-like or scalar float. Values of the radial coordinate to</span>
<span class="sd">                map to normalized poloidal flux. If R and Z are both scalar</span>
<span class="sd">                values, they are used as the coordinate pair for all of the</span>
<span class="sd">                values in t. Must have the same shape as Z unless the make_grid</span>
<span class="sd">                keyword is set. If the make_grid keyword is True, R must have</span>
<span class="sd">                shape (len_R,).</span>
<span class="sd">            Z: Array-like or scalar float. Values of the vertical coordinate to</span>
<span class="sd">                map to normalized poloidal flux. If R and Z are both scalar</span>
<span class="sd">                values, they are used as the coordinate pair for all of the</span>
<span class="sd">                values in t. Must have the same shape as R unless the make_grid</span>
<span class="sd">                keyword is set. If the make_grid keyword is True, Z must have</span>
<span class="sd">                shape (len_Z,).</span>
<span class="sd">            *args: slot for time input for consistent syntax with Equilibrium.rz2psi.</span>
<span class="sd">                will return dummy value for time if input in EqdskReader.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            sqrt: Boolean. Set to True to return the square root of normalized</span>
<span class="sd">                flux. Only the square root of positive psi_norm values is taken.</span>
<span class="sd">                Negative values are replaced with zeros, consistent with Steve</span>
<span class="sd">                Wolfe&#39;s IDL implementation efit_rz2rho.pro. Default is False</span>
<span class="sd">                (return psinorm).</span>
<span class="sd">            make_grid: Boolean. Set to True to pass R and Z through meshgrid</span>
<span class="sd">                before evaluating. If this is set to True, R and Z must each</span>
<span class="sd">                only have a single dimension, but can have different lengths.</span>
<span class="sd">                Default is False (do not form meshgrid).</span>
<span class="sd">            length_unit: String or 1. Length unit that R and Z are being given</span>
<span class="sd">                in. If a string is given, it must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R and Z given in meters).</span>
<span class="sd">            **kwargs: other keywords passed to Equilibrium.rz2psinorm are valid,</span>
<span class="sd">                but will return dummy values (i.e. for timebase keywords)</span>

<span class="sd">        Returns:</span>
<span class="sd">            psinorm: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned. If R and Z both have the same shape then</span>
<span class="sd">                psinorm has this shape as well. If the make_grid keyword was</span>
<span class="sd">                True then psinorm has shape (len(Z), len(R)).</span>

<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance EqdskReader:</span>

<span class="sd">        Find single psinorm value at R=0.6m, Z=0.0m:</span>
<span class="sd">        psi_val = Eq_instance.rz2psinorm(0.6, 0)</span>

<span class="sd">        Find psinorm values at (R, Z) points (0.6m, 0m) and (0.8m, 0m).</span>
<span class="sd">         Note that the Z vector must be fully specified,</span>
<span class="sd">        even if the values are all the same:</span>
<span class="sd">        psi_arr = Eq_instance.rz2psinorm([0.6, 0.8], [0, 0])</span>

<span class="sd">        Find psinorm values on grid defined by 1D vector of radial positions R</span>
<span class="sd">        and 1D vector of vertical positions Z:</span>
<span class="sd">        psi_mat = Eq_instance.rz2psinorm(R, Z, make_grid=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rz2psinorm</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2phinorm"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2phinorm">[docs]</a>    <span class="k">def</span> <span class="nf">rz2phinorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">sqrt</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">make_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates normalized toroidal flux at a given (R,Z).</span>
<span class="sd">        Wrapper for Equilibrium.rz2phinorm masking out timebase dependence.</span>

<span class="sd">        Args:</span>
<span class="sd">            R: Array-like or scalar float. Values of the radial coordinate to</span>
<span class="sd">                map to normalized toroidal flux. Must have the same shape as Z </span>
<span class="sd">                unless the make_grid keyword is set. If the make_grid keyword </span>
<span class="sd">                is True, R must have shape (len_R,).</span>
<span class="sd">            Z: Array-like or scalar float. Values of the vertical coordinate to</span>
<span class="sd">                map to normalized toroidal flux. Must have the same shape as R </span>
<span class="sd">                unless the make_grid keyword is set. If the make_grid keyword </span>
<span class="sd">                is True, Z must have shape (len_Z,).</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            sqrt: Boolean. Set to True to return the square root of normalized</span>
<span class="sd">                flux. Only the square root of positive phi_norm values is taken.</span>
<span class="sd">                Negative values are replaced with zeros, consistent with Steve</span>
<span class="sd">                Wolfe&#39;s IDL implementation efit_rz2rho.pro. Default is False</span>
<span class="sd">                (return phinorm).</span>
<span class="sd">            make_grid: Boolean. Set to True to pass R and Z through meshgrid</span>
<span class="sd">                before evaluating. If this is set to True, R and Z must each</span>
<span class="sd">                only have a single dimension, but can have different lengths.</span>
<span class="sd">                Default is False (do not form meshgrid).</span>
<span class="sd">            kind: String or non-negative int. Specifies the type of interpolation</span>
<span class="sd">                to be performed in getting from psinorm to phinorm. This is</span>
<span class="sd">                passed to scipy.interpolate.interp1d. Valid options are:</span>
<span class="sd">                &#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;</span>
<span class="sd">                If this keyword is an integer, it specifies the order of spline</span>
<span class="sd">                to use. See the documentation for interp1d for more details.</span>
<span class="sd">                Default value is &#39;cubic&#39; (3rd order spline interpolation). On</span>
<span class="sd">                some builds of scipy, this can cause problems, in which case</span>
<span class="sd">                you should try &#39;linear&#39; until you can rebuild your scipy install.</span>
<span class="sd">            length_unit: String or 1. Length unit that R and Z are being given</span>
<span class="sd">                in. If a string is given, it must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R and Z given in meters).</span>

<span class="sd">        Returns:</span>
<span class="sd">            phinorm: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned. If R and Z both have the same shape then</span>
<span class="sd">                phinorm has this shape as well. If the make_grid keyword was</span>
<span class="sd">                True then phinorm has shape (len(Z), len(R)).</span>

<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance of EqdskReader.</span>

<span class="sd">        Find single phinorm value at R=0.6m, Z=0.0m:</span>
<span class="sd">        phi_val = Eq_instance.rz2phinorm(0.6, 0)</span>
<span class="sd">        </span>
<span class="sd">        Find phinorm values at (R, Z) points (0.6m, 0m) and (0.8m, 0m).</span>
<span class="sd">        Note that the Z vector must be fully specified,</span>
<span class="sd">        even if the values are all the same:</span>
<span class="sd">        phi_arr = Eq_instance.rz2phinorm([0.6, 0.8], [0, 0])</span>

<span class="sd">        Find phinorm values on grid defined by 1D vector of radial positions R</span>
<span class="sd">        and 1D vector of vertical positions Z:</span>
<span class="sd">        phi_mat = Eq_instance.rz2phinorm(R, Z, make_grid=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;sqrt&#39;</span><span class="p">:</span><span class="n">sqrt</span><span class="p">,</span><span class="s">&#39;make_grid&#39;</span><span class="p">:</span><span class="n">make_grid</span><span class="p">,</span><span class="s">&#39;length_unit&#39;</span><span class="p">:</span><span class="n">length_unit</span><span class="p">,</span><span class="s">&#39;kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">,</span><span class="s">&#39;rho&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rz2phinorm</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2volnorm"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2volnorm">[docs]</a>    <span class="k">def</span> <span class="nf">rz2volnorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the normalized flux surface volume.</span>
<span class="sd">        Not implemented for EqdskReader, as necessary parameter</span>
<span class="sd">        is not read from a/g-files.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: in all cases.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;Cannot calculate volnorm from g-file equilibria.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2rho"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2rho">[docs]</a>    <span class="k">def</span> <span class="nf">rz2rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">sqrt</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">make_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the passed (R, Z) coordinates into one of several normalized coordinates.</span>
<span class="sd">        Wrapper for Equilibrium.rz2rho masking timebase dependence.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            method: String. Indicates which normalized coordinates to use.</span>
<span class="sd">                Valid options are:</span>
<span class="sd">                    psinorm     Normalized poloidal flux</span>
<span class="sd">                    phinorm     Normalized toroidal flux</span>
<span class="sd">                    volnorm     Normalized volume</span>
<span class="sd">            R: Array-like or scalar float. Values of the radial coordinate to</span>
<span class="sd">                map to normalized coordinate. Must have the same shape as Z </span>
<span class="sd">                unless the make_grid keyword is set. If the make_grid keyword</span>
<span class="sd">                is True, R must have shape (len_R,).</span>
<span class="sd">            Z: Array-like or scalar float. Values of the vertical coordinate to</span>
<span class="sd">                map to normalized coordinate. Must have the same shape as R </span>
<span class="sd">                unless the make_grid keyword is set. If the make_grid keyword </span>
<span class="sd">                is True, Z must have shape (len_Z,).</span>
<span class="sd">        </span>
<span class="sd">        Kwargs:</span>
<span class="sd">            sqrt: Boolean. Set to True to return the square root of normalized</span>
<span class="sd">                coordinate. Only the square root of positive values is taken.</span>
<span class="sd">                Negative values are replaced with zeros, consistent with Steve</span>
<span class="sd">                Wolfe&#39;s IDL implementation efit_rz2rho.pro. Default is False</span>
<span class="sd">                (return normalized coordinate itself).</span>
<span class="sd">            make_grid: Boolean. Set to True to pass R and Z through meshgrid</span>
<span class="sd">                before evaluating. If this is set to True, R and Z must each</span>
<span class="sd">                only have a single dimension, but can have different lengths.</span>
<span class="sd">                Default is False (do not form meshgrid).</span>
<span class="sd">            kind (phinorm and volnorm only): String or non-negative int.</span>
<span class="sd">                Specifies the type of interpolation to be performed in getting</span>
<span class="sd">                from psinorm to phinorm or volnorm. This is passed to</span>
<span class="sd">                scipy.interpolate.interp1d. Valid options are:</span>
<span class="sd">                &#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;</span>
<span class="sd">                If this keyword is an integer, it specifies the order of spline</span>
<span class="sd">                to use. See the documentation for interp1d for more details.</span>
<span class="sd">                Default value is &#39;cubic&#39; (3rd order spline interpolation). On</span>
<span class="sd">                some builds of scipy, this can cause problems, in which case</span>
<span class="sd">                you should try &#39;linear&#39; until you can rebuild your scipy install.</span>
<span class="sd">            length_unit: String or 1. Length unit that R and Z are being given</span>
<span class="sd">                in. If a string is given, it must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R and Z given in meters).</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            rho: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned. If R and Z both have the same shape then</span>
<span class="sd">                rho has this shape as well. If the make_grid keyword was True</span>
<span class="sd">                then rho has shape (len(Z), len(R)).</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If method is not one of the supported values.</span>
<span class="sd">        </span>
<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance of the appropriate</span>
<span class="sd">        extension of the Equilibrium abstract class.</span>

<span class="sd">        Find single psinorm value at R=0.6m, Z=0.0m:</span>
<span class="sd">        psi_val = Eq_instance.rz2rho(&#39;psinorm&#39;, 0.6, 0)</span>

<span class="sd">        Find psinorm values at (R, Z) points (0.6m, 0m) and (0.8m, 0m).</span>
<span class="sd">        Note that the Z vector must be fully specified,</span>
<span class="sd">        even if the values are all the same:</span>
<span class="sd">        psi_arr = Eq_instance.rz2rho(&#39;psinorm&#39;, [0.6, 0.8], [0, 0])</span>

<span class="sd">        Find psinorm values on grid defined by 1D vector of radial positions R</span>
<span class="sd">        and 1D vector of vertical positions Z:</span>
<span class="sd">        psi_mat = Eq_instance.rz2rho(&#39;psinorm&#39;, R, Z, make_grid=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s">&#39;psinorm&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;sqrt&#39;</span><span class="p">:</span><span class="n">sqrt</span><span class="p">,</span><span class="s">&#39;make_grid&#39;</span><span class="p">:</span><span class="n">make_grid</span><span class="p">,</span><span class="s">&#39;length_unit&#39;</span><span class="p">:</span><span class="n">length_unit</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;sqrt&#39;</span><span class="p">:</span><span class="n">sqrt</span><span class="p">,</span><span class="s">&#39;make_grid&#39;</span><span class="p">:</span><span class="n">make_grid</span><span class="p">,</span><span class="s">&#39;rho&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">,</span><span class="s">&#39;length_unit&#39;</span><span class="p">:</span><span class="n">length_unit</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rz2rho</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.rz2rmid"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.rz2rmid">[docs]</a>    <span class="k">def</span> <span class="nf">rz2rmid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">sqrt</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">make_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">rho</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps the given points to the outboard midplane major radius, R_mid.</span>
<span class="sd">        Wrapper for Equilibrium.rz2rmid masking timebase dependence.</span>
<span class="sd">        </span>
<span class="sd">        Based on the IDL version efit_rz2rmid.pro by Steve Wolfe.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            R: Array-like or scalar float. Values of the radial coordinate to</span>
<span class="sd">                map to midplane radius. Must have the same shape as Z unless </span>
<span class="sd">                the make_grid keyword is set. If the make_grid keyword is True,</span>
<span class="sd">                R must have shape (len_R,).</span>
<span class="sd">            Z: Array-like or scalar float. Values of the vertical coordinate to</span>
<span class="sd">                map to midplane radius. Must have the same shape as R unless the</span>
<span class="sd">                make_grid keyword is set. If the make_grid keyword is True, Z </span>
<span class="sd">                must have shape (len_Z,).</span>
<span class="sd">        </span>
<span class="sd">        Kwargs:</span>
<span class="sd">            sqrt: Boolean. Set to True to return the square root of midplane</span>
<span class="sd">                radius. Only the square root of positive values is taken.</span>
<span class="sd">                Negative values are replaced with zeros, consistent with Steve</span>
<span class="sd">                Wolfe&#39;s IDL implementation efit_rz2rho.pro. Default is False</span>
<span class="sd">                (return R_mid itself).</span>
<span class="sd">            make_grid: Boolean. Set to True to pass R and Z through meshgrid</span>
<span class="sd">                before evaluating. If this is set to True, R and Z must each</span>
<span class="sd">                only have a single dimension, but can have different lengths.</span>
<span class="sd">                Default is False (do not form meshgrid).</span>
<span class="sd">            rho: Boolean. Set to True to return r/a (normalized minor radius)</span>
<span class="sd">                instead of R_mid. Default is False (return major radius, R_mid).</span>
<span class="sd">            kind: String or non-negative int. Specifies the type of interpolation</span>
<span class="sd">                to be performed in getting from psinorm to R_mid. This is</span>
<span class="sd">                passed to scipy.interpolate.interp1d. Valid options are:</span>
<span class="sd">                &#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;</span>
<span class="sd">                If this keyword is an integer, it specifies the order of spline</span>
<span class="sd">                to use. See the documentation for interp1d for more details.</span>
<span class="sd">                Default value is &#39;cubic&#39; (3rd order spline interpolation). On</span>
<span class="sd">                some builds of scipy, this can cause problems, in which case</span>
<span class="sd">                you should try &#39;linear&#39; until you can rebuild your scipy install.</span>
<span class="sd">            length_unit: String or 1. Length unit that R and Z are being given</span>
<span class="sd">                in AND that R_mid is returned in. If a string is given, it</span>
<span class="sd">                must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R and Z given in meters, R_mid returned in meters).</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            R_mid: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned. If R and Z both have the same shape then</span>
<span class="sd">                R_mid has this shape as well. If the make_grid keyword was True</span>
<span class="sd">                then R_mid has shape (len(Z), len(R)).</span>
<span class="sd">        </span>
<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance of the appropriate</span>
<span class="sd">        extension of the Equilibrium abstract class.</span>

<span class="sd">        Find single R_mid value at R=0.6m, Z=0.0m:</span>
<span class="sd">        R_mid_val = Eq_instance.rz2rmid(0.6, 0)</span>

<span class="sd">        Find R_mid values at (R, Z) points (0.6m, 0m) and (0.8m, 0m).</span>
<span class="sd">        Note that the Z vector must be fully specified,</span>
<span class="sd">        even if the values are all the same:</span>
<span class="sd">        R_mid_arr = Eq_instance.rz2rmid([0.6, 0.8], [0, 0])</span>

<span class="sd">        Find R_mid values on grid defined by 1D vector of radial positions R</span>
<span class="sd">        and 1D vector of vertical positions Z:</span>
<span class="sd">        R_mid_mat = Eq_instance.rz2rmid(R, Z, make_grid=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;sqrt&#39;</span><span class="p">:</span><span class="n">sqrt</span><span class="p">,</span><span class="s">&#39;make_grid&#39;</span><span class="p">:</span><span class="n">make_grid</span><span class="p">,</span><span class="s">&#39;rho&#39;</span><span class="p">:</span><span class="n">rho</span><span class="p">,</span><span class="s">&#39;kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">,</span><span class="s">&#39;length_unit&#39;</span><span class="p">:</span><span class="n">length_unit</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">rz2rmid</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.psinorm2rmid"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.psinorm2rmid">[docs]</a>    <span class="k">def</span> <span class="nf">psinorm2rmid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">psi_norm</span><span class="p">,</span><span class="n">rho</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outboard R_mid location corresponding to the passed psi_norm (normalized poloidal flux) values.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            psi_norm: Array-like or scalar float. Values of the normalized</span>
<span class="sd">                poloidal flux to map to midplane radius.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            rho: Boolean. Set to True to return r/a (normalized minor radius)</span>
<span class="sd">                instead of R_mid. Default is False (return major radius, R_mid).</span>
<span class="sd">            kind: String or non-negative int. Specifies the type of interpolation</span>
<span class="sd">                to be performed in getting from psinorm to R_mid. This is</span>
<span class="sd">                passed to scipy.interpolate.interp1d. Valid options are:</span>
<span class="sd">                &#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;</span>
<span class="sd">                If this keyword is an integer, it specifies the order of spline</span>
<span class="sd">                to use. See the documentation for interp1d for more details.</span>
<span class="sd">                Default value is &#39;cubic&#39; (3rd order spline interpolation). On</span>
<span class="sd">                some builds of scipy, this can cause problems, in which case</span>
<span class="sd">                you should try &#39;linear&#39; until you can rebuild your scipy install.</span>
<span class="sd">            length_unit: String or 1. Length unit that R_mid is returned in. If</span>
<span class="sd">                a string is given, it must be a valid unit specifier:</span>
<span class="sd">                    &#39;m&#39;         meters</span>
<span class="sd">                    &#39;cm&#39;        centimeters</span>
<span class="sd">                    &#39;mm&#39;        millimeters</span>
<span class="sd">                    &#39;in&#39;        inches</span>
<span class="sd">                    &#39;ft&#39;        feet</span>
<span class="sd">                    &#39;yd&#39;        yards</span>
<span class="sd">                    &#39;smoot&#39;     smoots</span>
<span class="sd">                    &#39;cubit&#39;     cubits</span>
<span class="sd">                    &#39;hand&#39;      hands</span>
<span class="sd">                    &#39;default&#39;   meters</span>
<span class="sd">                If length_unit is 1 or None, meters are assumed. The default</span>
<span class="sd">                value is 1 (R_mid returned in meters).</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            R_mid: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned.</span>
<span class="sd">        </span>
<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance of the appropriate</span>
<span class="sd">        extension of the Equilibrium abstract class.</span>

<span class="sd">        Find single R_mid value for psinorm=0.7:</span>
<span class="sd">        R_mid_val = Eq_instance.psinorm2rmid(0.7)</span>

<span class="sd">        Find R_mid values at psi_norm values of 0.5 and 0.7.</span>
<span class="sd">        Note that the Z vector must be fully specified, even if the</span>
<span class="sd">        values are all the same:</span>
<span class="sd">        R_mid_arr = Eq_instance.psinorm2rmid([0.5, 0.7])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;rho&#39;</span><span class="p">:</span><span class="n">rho</span><span class="p">,</span><span class="s">&#39;kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">,</span><span class="s">&#39;length_unit&#39;</span><span class="p">:</span><span class="n">length_unit</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">psinorm2rmid</span><span class="p">(</span><span class="n">psi_norm</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.psinorm2volnorm"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.psinorm2volnorm">[docs]</a>    <span class="k">def</span> <span class="nf">psinorm2volnorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outboard R_mid location corresponding to psi_norm (normalized poloidal flux) values.</span>
<span class="sd">        Not implemented for EqdskReader, as necessary parameter</span>
<span class="sd">        is not read from a/g-files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;Cannot calculate volnorm from g-file equilibria.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.psinorm2phinorm"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.psinorm2phinorm">[docs]</a>    <span class="k">def</span> <span class="nf">psinorm2phinorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">psi_norm</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;cubic&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the normalized toroidal flux corresponding to the passed psi_norm (normalized poloidal flux) values.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            psi_norm: Array-like or scalar float. Values of the normalized</span>
<span class="sd">                poloidal flux to map to normalized toroidal flux.</span>
<span class="sd">        </span>
<span class="sd">        Kwargs:</span>
<span class="sd">            kind: String or non-negative int. Specifies the type of interpolation</span>
<span class="sd">                to be performed in getting from psinorm to phinorm. This is</span>
<span class="sd">                &#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;</span>
<span class="sd">                passed to scipy.interpolate.interp1d. Valid options are:</span>
<span class="sd">                If this keyword is an integer, it specifies the order of spline</span>
<span class="sd">                to use. See the documentation for interp1d for more details.</span>
<span class="sd">                Default value is &#39;cubic&#39; (3rd order spline interpolation). On</span>
<span class="sd">                some builds of scipy, this can cause problems, in which case</span>
<span class="sd">                you should try &#39;linear&#39; until you can rebuild your scipy install.</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            phinorm: Array or scalar float. If all of the input arguments are</span>
<span class="sd">                scalar, then a scalar is returned. Otherwise, a scipy Array</span>
<span class="sd">                instance is returned.</span>
<span class="sd">        </span>
<span class="sd">        Examples:</span>
<span class="sd">        All assume that Eq_instance is a valid instance of the appropriate</span>
<span class="sd">        extension of the Equilibrium abstract class.</span>

<span class="sd">        Find single phinorm value for psinorm=0.7:</span>
<span class="sd">        phinorm_val = Eq_instance.psinorm2phinorm(0.7)</span>

<span class="sd">        Find phinorm values at psi_norm values of 0.5 and 0.7.</span>
<span class="sd">        Note that the Z vector must be fully specified, even if the</span>
<span class="sd">        values are all the same:</span>
<span class="sd">        phinorm_arr = Eq_instance.psinorm2phinorm([0.5, 0.7])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimeBase</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;return_t&#39;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span><span class="s">&#39;kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">psinorm2phinorm</span><span class="p">(</span><span class="n">psi_norm</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c">#################</span>
    <span class="c"># data handlers #</span>
    <span class="c">#################</span>
</div>
<div class="viewcode-block" id="EqdskReader.getTimeBase"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getTimeBase">[docs]</a>    <span class="k">def</span> <span class="nf">getTimeBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT time point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getCurrentSign"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getCurrentSign">[docs]</a>    <span class="k">def</span> <span class="nf">getCurrentSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the sign of the current, based on the check in Steve Wolfe&#39;s</span>
<span class="sd">        IDL implementation efit_rz2psi.pro.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">scipy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getIpCalc</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mf">1e5</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentSign</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFluxGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFluxGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT flux grid, [r,z]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_psiRZ</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getRGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getRGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getRGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT R-axis [r]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rGrid&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rGrid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getZGrid"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getZGrid">[docs]</a>    <span class="k">def</span> <span class="nf">getZGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT Z-axis [z]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_zGrid&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zGrid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFluxAxis"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFluxAxis">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns psi on magnetic axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># scale by current sign for consistency with sign of psiRZ.</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentSign</span><span class="p">()</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psiAxis</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFluxLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFluxLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns psi at separatrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># scale by current sign for consistency with sign of psiRZ.</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentSign</span><span class="p">()</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psiLCFS</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getRLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getRLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getRLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns array of R-values of LCFS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_RLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getZLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getZLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getZLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns array of Z-values of LCFS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_ZLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ZLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFluxVol"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFluxVol">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxVol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#returns volume contained within a flux surface as function of psi, volp(psi,t)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getVolLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getVolLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getVolLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns volume with LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_volLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getRmidPsi"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getRmidPsi">[docs]</a>    <span class="k">def</span> <span class="nf">getRmidPsi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane major radius of flux surfaces.</span>
<span class="sd">        Data not read from a/g-files, not implemented for EqdskReader.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: RmidPsi not read from a/g-files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;RmidPsi not read from a/g-files.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFluxPres"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFluxPres">[docs]</a>    <span class="k">def</span> <span class="nf">getFluxPres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns pressure on flux surface p(psi)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fluxPres</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getElongation"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getElongation">[docs]</a>    <span class="k">def</span> <span class="nf">getElongation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns elongation of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kappa</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getUpperTriangularity"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getUpperTriangularity">[docs]</a>    <span class="k">def</span> <span class="nf">getUpperTriangularity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns upper triangularity of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dupper</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getLowerTriangularity"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getLowerTriangularity">[docs]</a>    <span class="k">def</span> <span class="nf">getLowerTriangularity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns lower triangularity of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dlower</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getShaping"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getShaping">[docs]</a>    <span class="k">def</span> <span class="nf">getShaping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls LCFS elongation, upper/lower triangularity.</span>
<span class="sd">        Returns namedtuple containing [kappa,delta_u,delta_l].</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElongation</span><span class="p">()</span>
            <span class="n">du</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperTriangularity</span><span class="p">()</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerTriangularity</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Shaping&#39;</span><span class="p">,[</span><span class="s">&#39;kappa&#39;</span><span class="p">,</span><span class="s">&#39;delta_u&#39;</span><span class="p">,</span><span class="s">&#39;delta_l&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">kap</span><span class="p">,</span><span class="n">delta_u</span><span class="o">=</span><span class="n">du</span><span class="p">,</span><span class="n">delta_l</span><span class="o">=</span><span class="n">dl</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span> 
</div>
<div class="viewcode-block" id="EqdskReader.getMagR"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getMagR">[docs]</a>    <span class="k">def</span> <span class="nf">getMagR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns major radius of magnetic axis.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rmag&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getMagZ"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getMagZ">[docs]</a>    <span class="k">def</span> <span class="nf">getMagZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns Z of magnetic axis.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_zmag&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zmag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getAreaLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getAreaLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getAreaLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns surface area of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_areaLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areaLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getAOut"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getAOut">[docs]</a>    <span class="k">def</span> <span class="nf">getAOut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane minor radius of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_aLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getRmidOut"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getRmidOut">[docs]</a>    <span class="k">def</span> <span class="nf">getRmidOut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane major radius of LCFS.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_RmidLCFS&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RmidLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getGeometry"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">getGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls dimensional geometry parameters.</span>
<span class="sd">        Returns namedtuple containing [Rmag,Zmag,AreaLCFS,aOut,RmidOut]</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            length_unit: TODO</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Rmag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMagR</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">Zmag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMagZ</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">AreaLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAreaLCFS</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">aOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAOut</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">RmidOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRmidOut</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="p">(</span><span class="n">length_unit</span> <span class="k">if</span> <span class="n">length_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Geometry&#39;</span><span class="p">,[</span><span class="s">&#39;Rmag&#39;</span><span class="p">,</span><span class="s">&#39;Zmag&#39;</span><span class="p">,</span><span class="s">&#39;AreaLCFS&#39;</span><span class="p">,</span><span class="s">&#39;aOut&#39;</span><span class="p">,</span><span class="s">&#39;RmidOut&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">Rmag</span><span class="o">=</span><span class="n">Rmag</span><span class="p">,</span><span class="n">Zmag</span><span class="o">=</span><span class="n">Zmag</span><span class="p">,</span><span class="n">AreaLCFS</span><span class="o">=</span><span class="n">AreaLCFS</span><span class="p">,</span><span class="n">aOut</span><span class="o">=</span><span class="n">aOut</span><span class="p">,</span><span class="n">RmidOut</span><span class="o">=</span><span class="n">RmidOut</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQProfile"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQProfile">[docs]</a>    <span class="k">def</span> <span class="nf">getQProfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns safety factor q(psi).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qpsi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQ0"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQ0">[docs]</a>    <span class="k">def</span> <span class="nf">getQ0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns safety factor q on-axis, q0.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQ95"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQ95">[docs]</a>    <span class="k">def</span> <span class="nf">getQ95</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns safety factor q at 95% flux surface.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q95</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQLCFS"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQLCFS">[docs]</a>    <span class="k">def</span> <span class="nf">getQLCFS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns safety factor q at LCFS (interpolated).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not loaded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qLCFS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQ1Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQ1Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ1Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane minor radius of q=1 surface.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq1&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="EqdskReader.getQ2Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQ2Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ2Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane minor radius of q=2 surface.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq2&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQ3Surf"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQ3Surf">[docs]</a>    <span class="k">def</span> <span class="nf">getQ3Surf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns outboard-midplane minor radius of q=3 surface.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLengthConversionFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultUnits</span><span class="p">[</span><span class="s">&#39;_rq3&#39;</span><span class="p">],</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">unit_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rq3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getQs"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getQs">[docs]</a>    <span class="k">def</span> <span class="nf">getQs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">length_unit</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls q-profile data.</span>
<span class="sd">        Returns namedtuple containing [q0,q95,qLCFS,rq1,rq2,rq3]</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ0</span><span class="p">()</span>
            <span class="n">q95</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ95</span><span class="p">()</span>
            <span class="n">qLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQLCFS</span><span class="p">()</span>
            <span class="n">rq1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ1Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">rq2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ2Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">rq3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getQ3Surf</span><span class="p">(</span><span class="n">length_unit</span><span class="o">=</span><span class="n">length_unit</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Qs&#39;</span><span class="p">,[</span><span class="s">&#39;q0&#39;</span><span class="p">,</span><span class="s">&#39;q95&#39;</span><span class="p">,</span><span class="s">&#39;qLCFS&#39;</span><span class="p">,</span><span class="s">&#39;rq1&#39;</span><span class="p">,</span><span class="s">&#39;rq2&#39;</span><span class="p">,</span><span class="s">&#39;rq3&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">q0</span><span class="o">=</span><span class="n">q0</span><span class="p">,</span><span class="n">q95</span><span class="o">=</span><span class="n">q95</span><span class="p">,</span><span class="n">qLCFS</span><span class="o">=</span><span class="n">qLCFS</span><span class="p">,</span><span class="n">rq1</span><span class="o">=</span><span class="n">rq1</span><span class="p">,</span><span class="n">rq2</span><span class="o">=</span><span class="n">rq2</span><span class="p">,</span><span class="n">rq3</span><span class="o">=</span><span class="n">rq3</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBtVac"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBtVac">[docs]</a>    <span class="k">def</span> <span class="nf">getBtVac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns vacuum toroidal field on-axis.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBtPla"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBtPla">[docs]</a>    <span class="k">def</span> <span class="nf">getBtPla</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns plasma toroidal field on-axis.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_btaxp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBpAvg"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBpAvg">[docs]</a>    <span class="k">def</span> <span class="nf">getBpAvg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns average poloidal field.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bpolav</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getFields"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getFields">[docs]</a>    <span class="k">def</span> <span class="nf">getFields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls vacuum and plasma toroidal field, poloidal field data.</span>
<span class="sd">        Returns namedtuple containing [BtVac,BtPla,BpAvg]</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">btaxv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBtVac</span><span class="p">()</span>
            <span class="n">btaxp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBtPla</span><span class="p">()</span>
            <span class="n">bpolav</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBpAvg</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Fields&#39;</span><span class="p">,[</span><span class="s">&#39;BtVac&#39;</span><span class="p">,</span><span class="s">&#39;BtPla&#39;</span><span class="p">,</span><span class="s">&#39;BpAvg&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">BtVac</span><span class="o">=</span><span class="n">btaxv</span><span class="p">,</span><span class="n">BtPla</span><span class="o">=</span><span class="n">btaxp</span><span class="p">,</span><span class="n">BpAvg</span><span class="o">=</span><span class="n">bpolav</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getIpCalc"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getIpCalc">[docs]</a>    <span class="k">def</span> <span class="nf">getIpCalc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT-calculated plasma current.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpCalc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getIpMeas"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getIpMeas">[docs]</a>    <span class="k">def</span> <span class="nf">getIpMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns measured plasma current.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_IpMeas</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getJp"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getJp">[docs]</a>    <span class="k">def</span> <span class="nf">getJp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns (r,z) grid of toroidal plasma current density.</span>
<span class="sd">        Data not read from g-file, not implemented for EqdskReader.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: Jp not read from g-file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;Jp not read from g-file.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBetaT"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBetaT">[docs]</a>    <span class="k">def</span> <span class="nf">getBetaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT-calculated toroidal beta.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betat</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBetaP"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBetaP">[docs]</a>    <span class="k">def</span> <span class="nf">getBetaP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT-calculated poloidal beta.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betap</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getLi"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getLi">[docs]</a>    <span class="k">def</span> <span class="nf">getLi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns internal inductance of plasma.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Li</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getBetas"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getBetas">[docs]</a>    <span class="k">def</span> <span class="nf">getBetas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls EFIT-calculated betas and internal inductance.</span>
<span class="sd">        Returns a namedtuple containing [betat,betap,Li]</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">betat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBetaT</span><span class="p">()</span>
            <span class="n">betap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBetaP</span><span class="p">()</span>
            <span class="n">Li</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLi</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Betas&#39;</span><span class="p">,[</span><span class="s">&#39;betat&#39;</span><span class="p">,</span><span class="s">&#39;betap&#39;</span><span class="p">,</span><span class="s">&#39;Li&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">betat</span><span class="o">=</span><span class="n">betat</span><span class="p">,</span><span class="n">betap</span><span class="o">=</span><span class="n">betap</span><span class="p">,</span><span class="n">Li</span><span class="o">=</span><span class="n">Li</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="EqdskReader.getDiamagFlux"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamagFlux">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagFlux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns diamagnetic flux.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getDiamagBetaT"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamagBetaT">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagBetaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns diamagnetic-loop measured toroidal beta.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betatd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getDiamagBetaP"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamagBetaP">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagBetaP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns diamagnetic-loop measured poloidal beta.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_betapd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getDiamagTauE"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamagTauE">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagTauE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns diamagnetic-loop energy confinement time.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauDiamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getDiamagWp"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamagWp">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamagWp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns diamagnetic-loop measured stored energy.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WDiamag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getDiamag"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getDiamag">[docs]</a>    <span class="k">def</span> <span class="nf">getDiamag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls diamagnetic flux, diamag. measured toroidal and poloidal beta, stored energy, and energy confinement time.</span>
<span class="sd">        Returns a namedtuple containing [diaFlux,diaBetat,diaBetap,diaTauE,diaWp]</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dFlux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagFlux</span><span class="p">()</span>
            <span class="n">betatd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagBetaT</span><span class="p">()</span>
            <span class="n">betapd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagBetaP</span><span class="p">()</span>
            <span class="n">dTau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagTauE</span><span class="p">()</span>
            <span class="n">dWp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiamagWp</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Diamag&#39;</span><span class="p">,[</span><span class="s">&#39;diaFlux&#39;</span><span class="p">,</span><span class="s">&#39;diaBetat&#39;</span><span class="p">,</span><span class="s">&#39;diaBetap&#39;</span><span class="p">,</span><span class="s">&#39;diaTauE&#39;</span><span class="p">,</span><span class="s">&#39;diaWp&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">diaFlux</span><span class="o">=</span><span class="n">dFlux</span><span class="p">,</span><span class="n">diaBetat</span><span class="o">=</span><span class="n">betatd</span><span class="p">,</span><span class="n">diaBetap</span><span class="o">=</span><span class="n">betapd</span><span class="p">,</span><span class="n">diaTauE</span><span class="o">=</span><span class="n">dTau</span><span class="p">,</span><span class="n">diaWp</span><span class="o">=</span><span class="n">dWp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getWMHD"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getWMHD">[docs]</a>    <span class="k">def</span> <span class="nf">getWMHD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT-calculated stored energy.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WMHD</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getTauMHD"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getTauMHD">[docs]</a>    <span class="k">def</span> <span class="nf">getTauMHD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT-calculated energy confinement time.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tauMHD</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getPinj"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getPinj">[docs]</a>    <span class="k">def</span> <span class="nf">getPinj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT injected power.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pinj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getWbdot"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getWbdot">[docs]</a>    <span class="k">def</span> <span class="nf">getWbdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT d/dt of magnetic stored energy</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wbdot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getWpdot"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getWpdot">[docs]</a>    <span class="k">def</span> <span class="nf">getWpdot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns EFIT d/dt of plasma stored energy.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Wpdot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EqdskReader.getEnergy"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pulls EFIT stored energy, energy confinement time, injected power, and d/dt of magnetic and plasma stored energy.</span>
<span class="sd">        Returns namedtuple containing [WMHD,tauMHD,Pinj,Wbdot,Wpdot]</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if a-file data is not read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WMHD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWMHD</span><span class="p">()</span>
            <span class="n">tauMHD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTauMHD</span><span class="p">()</span>
            <span class="n">Pinj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPinj</span><span class="p">()</span>
            <span class="n">Wbdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWbdot</span><span class="p">()</span>
            <span class="n">Wpdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getWpdot</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Energy&#39;</span><span class="p">,[</span><span class="s">&#39;WMHD&#39;</span><span class="p">,</span><span class="s">&#39;tauMHD&#39;</span><span class="p">,</span><span class="s">&#39;Pinj&#39;</span><span class="p">,</span><span class="s">&#39;Wbdot&#39;</span><span class="p">,</span><span class="s">&#39;Wpdot&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">(</span><span class="n">WMHD</span><span class="o">=</span><span class="n">WMHD</span><span class="p">,</span><span class="n">tauMHD</span><span class="o">=</span><span class="n">tauMHD</span><span class="p">,</span><span class="n">Pinj</span><span class="o">=</span><span class="n">Pinj</span><span class="p">,</span><span class="n">Wbdot</span><span class="o">=</span><span class="n">Wbdot</span><span class="p">,</span><span class="n">Wpdot</span><span class="o">=</span><span class="n">Wpdot</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;must read a-file for this data.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EqdskReader.getParam"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getParam">[docs]</a>    <span class="k">def</span> <span class="nf">getParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Backup function, applying a direct path input for tree-like data storage access</span>
<span class="sd">        for parameters not typically found in Equilbrium object.  Directly calls attributes</span>
<span class="sd">        read from g/a-files in copy-safe manner.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: String.  Parameter name for value stored in EqdskReader instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: raised if no attribute is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EqdskReader</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">is</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attr</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&#39;No attribute &quot;_</span><span class="si">%s</span><span class="s">&quot; found&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="EqdskReader.getMachineCrossSection"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.getMachineCrossSection">[docs]</a>    <span class="k">def</span> <span class="nf">getMachineCrossSection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to pull machine cross-section from data storage, convert to standard format for plotting routine.</span>
<span class="sd">        Not implemented for eqdsk class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;no machine cross section stored in g-files.&#39;</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="EqdskReader.plotFlux"><a class="viewcode-back" href="../../eqtools.html#eqtools.eqdskreader.EqdskReader.plotFlux">[docs]</a>    <span class="k">def</span> <span class="nf">plotFlux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        streamlined plotting of flux contours directly from psi grid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">psiRZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFluxGrid</span><span class="p">()</span>
            <span class="n">rGrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRGrid</span><span class="p">()</span>
            <span class="n">zGrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getZGrid</span><span class="p">()</span>

            <span class="n">RLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRLCFS</span><span class="p">()</span>
            <span class="n">ZLCFS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getZLCFS</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&#39;cannot plot EFIT flux map.&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;$R$ (m)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;$Z$ (m)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gfilename</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">rGrid</span><span class="p">,</span><span class="n">zGrid</span><span class="p">,</span><span class="n">psiRZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">rGrid</span><span class="p">,</span><span class="n">zGrid</span><span class="p">,</span><span class="n">psiRZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyles</span><span class="o">=</span><span class="s">&#39;solid&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RLCFS</span><span class="p">,</span><span class="n">ZLCFS</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                



                
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../index.html">eqtools 0.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Mark Chilenski, Ian Faust and John Walk.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>