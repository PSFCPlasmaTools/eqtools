#include <math.h>

/*****************************************************************
 
    This file is part of the EqTools package.

    EqTools is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    EqTools is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with EqTools.  If not, see <http://www.gnu.org/licenses/>.

    Copyright 2013 Ian C. Faust

******************************************************************/

int A[64][64] = {
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -8, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, -4, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, -16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, -2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 4, 2, 0, 0, 0, 0, 0, 0, -4, -2, 0, 0, 0, 0, 0, 0, 12, -12, 0, 0, 0, 0, 0, 0, -12, 12, 0, 0, 0, 0, 0, 0, 4, 2, 0, 0, 0, 0, 0, 0, -4, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, -2, -2, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, -8, 8, 0, 0, 0, 0, 0, 0, 8, -8, 0, 0, 0, 0, 0, 0, -2, -2, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, -20, 0, 0, 0, 16, 0, 0, 0, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 4, 0, 0, 0, 14, 0, 0, 0, -16, 0, 0, 0, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, -10, 0, 0, 0, 8, 0, 0, 0, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, -8, -4, 0, 0, -28, -14, 0, 0, 32, 16, 0, 0, 4, 2, 0, 0, -24, 24, 0, 0, 60, -60, 0, 0, -48, 48, 0, 0, 12, -12, 0, 0, -8, -4, 0, 0, 20, 10, 0, 0, -16, -8, 0, 0, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 4, 4, 0, 0, 14, 14, 0, 0, -16, -16, 0, 0, -2, -2, 0, 0, 16, -16, 0, 0, -40, 40, 0, 0, 32, -32, 0, 0, -8, 8, 0, 0, 4, 4, 0, 0, -10, -10, 0, 0, 8, 8, 0, 0, -2, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, 0, 0, 0, 12, 0, 0, 0, -12, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, -2, 0, 0, 0, -10, 0, 0, 0, 10, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 0, 0, 0, 6, 0, 0, 0, -6, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 4, 2, 0, 0, 20, 10, 0, 0, -20, -10, 0, 0, -4, -2, 0, 0, 12, -12, 0, 0, -36, 36, 0, 0, 36, -36, 0, 0, -12, 12, 0, 0, 4, 2, 0, 0, -12, -6, 0, 0, 12, 6, 0, 0, -4, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, -2, -2, 0, 0, -10, -10, 0, 0, 10, 10, 0, 0, 2, 2, 0, 0, -8, 8, 0, 0, 24, -24, 0, 0, -24, 24, 0, 0, 8, -8, 0, 0, -2, -2, 0, 0, 6, 6, 0, 0, -6, -6, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, -2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 4, 2, -4, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, -12, -12, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 2, -4, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, -2, -2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -8, 8, 8, -8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 0, 2, 0, 0, 0, 0, 0, -2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, 0, 1, 0, 0, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 1, -2, -1, 0, 0, 0, 0, 2, 1, -2, -1, 0, 0, 0, 0, 6, -6, -6, 6, 0, 0, 0, 0, 6, -6, -6, 6, 0, 0, 0, 0, 2, 1, -2, -1, 0, 0, 0, 0, 2, 1, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, -1, 1, 1, 0, 0, 0, 0, -1, -1, 1, 1, 0, 0, 0, 0, -4, 4, 4, -4, 0, 0, 0, 0, -4, 4, 4, -4, 0, 0, 0, 0, -1, -1, 1, 1, 0, 0, 0, 0, -1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, -4, 0, 14, 0, -14, 0, -8, 0, 8, 0, 2, 0, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 0, -2, 0, 7, 0, -7, 0, -4, 0, 4, 0, 1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, -2, 0, 7, 0, -7, 0, -4, 0, 4, 0, 1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-4, -2, 4, 2, -14, -7, 14, 7, 8, 4, -8, -4, -2, -1, 2, 1, -12, 12, 12, -12, -42, 42, 42, -42, 24, -24, -24, 24, -6, 6, 6, -6, -4, -2, 4, 2, -14, -7, 14, 7, 8, 4, -8, -4, -2, -1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 2, -2, -2, 7, 7, -7, -7, -4, -4, 4, 4, 1, 1, -1, -1, 8, -8, -8, 8, 28, -28, -28, 28, -16, 16, 16, -16, 4, -4, -4, 4, 2, 2, -2, -2, 7, 7, -7, -7, -4, -4, 4, 4, 1, 1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 0, 2, 0, -10, 0, 10, 0, 6, 0, -6, 0, -2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, 0, 1, 0, -5, 0, 5, 0, 3, 0, -3, 0, -1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 1, 0, -5, 0, 5, 0, 3, 0, -3, 0, -1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 1, -2, -1, 10, 5, -10, -5, -6, -3, 6, 3, 2, 1, -2, -1, 6, -6, -6, 6, 30, -30, -30, 30, -18, 18, 18, -18, 6, -6, -6, 6, 2, 1, -2, -1, 10, 5, -10, -5, -6, -3, 6, 3, 2, 1, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, -1, 1, 1, -5, -5, 5, 5, 3, 3, -3, -3, -1, -1, 1, 1, -4, 4, 4, -4, -20, 20, 20, -20, 12, -12, -12, 12, -4, 4, 4, -4, -1, -1, 1, 1, -5, -5, 5, 5, 3, 3, -3, -3, -1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, -24, -8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 24, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 4, 12, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, -12, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, -12, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 12, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, -8, -28, -4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -28, 118, -32, -22, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -20, -40, 104, -8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, -26, -8, 2, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 4, 16, 8, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, -74, 18, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 32, -72, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 14, 10, -2, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 12, -4, 0, 0, 0, 0, 0, 4, -12, -4, 0, 0, 0, 0, 0, 2, -12, -2, 0, 0, 0, 0, 0, 2, 12, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 6, -2, 0, 0, 0, 0, 0, 2, -6, -2, 0, 0, 0, 0, 0, 1, -6, -1, 0, 0, 0, 0, 0, 1, 6, -1, 0, 0, 0, 0, 0, 2, 6, -2, 0, 0, 0, 0, 0, 2, -6, -2, 0, 0, 0, 0, 0, 1, -6, -1, 0, 0, 0, 0, 0, 1, 6, -1, 0, 0, 0, 0, 0}, 
 {-4, -14, -2, 2, 0, 0, 0, 0, -4, 10, 10, 2, 0, 0, 0, 0, -14, -13, 56, -11, 0, 0, 0, 0, -14, 35, -28, -11, 0, 0, 0, 0, -10, 28, -32, -4, 0, 0, 0, 0, -10, -20, 52, -4, 0, 0, 0, 0, -2, 11, 8, 1, 0, 0, 0, 0, -2, -13, -4, 1, 0, 0, 0, 0}, 
 {2, 8, 4, -2, 0, 0, 0, 0, 2, -4, -8, -2, 0, 0, 0, 0, 9, 11, -39, 7, 0, 0, 0, 0, 9, -25, 21, 7, 0, 0, 0, 0, 6, -20, 24, 2, 0, 0, 0, 0, 6, 16, -36, 2, 0, 0, 0, 0, 1, -5, -7, -1, 0, 0, 0, 0, 1, 7, 5, -1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -8, -24, 8, 0, -28, 60, 28, 0, 16, -48, -16, 0, -4, 12, 4, 0, -4, 24, 4, 0, -14, -60, 14, 0, 8, 48, -8, 0, -2, -12, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-4, -12, 4, 0, -14, -42, 14, 0, 8, 48, -8, 0, -2, 6, 2, 0, -2, 12, 2, 0, -7, 42, 7, 0, 4, -48, -4, 0, -1, -6, 1, 0, -4, -12, 4, 0, -14, 30, 14, 0, 8, -24, -8, 0, -2, 6, 2, 0, -2, 12, 2, 0, -7, -30, 7, 0, 4, 24, -4, 0, -1, -6, 1, 0}, 
 {8, 28, 4, -4, 28, 98, 14, -14, -16, -104, -32, 8, 4, -10, -10, -2, 28, 26, -112, 22, 98, -341, 40, 77, -56, 284, -40, -44, 14, -35, 28, 11, 20, -56, 64, 8, 70, 92, -280, 28, -40, -80, 208, -16, 10, 20, -52, 4, 4, -22, -16, -2, 14, 67, 16, -7, -8, -52, -16, 4, 2, 13, 4, -1}, 
 {-4, -16, -8, 4, -14, -56, -28, 14, 8, 56, 40, -8, -2, 4, 8, 2, -18, -22, 78, -14, -63, 211, -15, -49, 36, -172, 12, 28, -9, 25, -21, -7, -12, 40, -48, -4, -42, -76, 192, -14, 24, 64, -144, 8, -6, -16, 36, -2, -2, 10, 14, 2, -7, -37, -23, 7, 4, 28, 20, -4, -1, -7, -5, 1}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 12, -4, 0, 20, -36, -20, 0, -12, 36, 12, 0, 4, -12, -4, 0, 2, -12, -2, 0, 10, 36, -10, 0, -6, -36, 6, 0, 2, 12, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 6, -2, 0, 10, 30, -10, 0, -6, -30, 6, 0, 2, -6, -2, 0, 1, -6, -1, 0, 5, -30, -5, 0, -3, 30, 3, 0, 1, 6, -1, 0, 2, 6, -2, 0, 10, -18, -10, 0, -6, 18, 6, 0, 2, -6, -2, 0, 1, -6, -1, 0, 5, 18, -5, 0, -3, -18, 3, 0, 1, 6, -1, 0}, 
 {-4, -14, -2, 2, -20, -70, -10, 10, 12, 66, 18, -6, -4, 10, 10, 2, -14, -13, 56, -11, -70, 223, -8, -55, 42, -201, 36, 33, -14, 35, -28, -11, -10, 28, -32, -4, -50, -52, 176, -20, 30, 60, -156, 12, -10, -20, 52, -4, -2, 11, 8, 1, -10, -41, -8, 5, 6, 39, 12, -3, -2, -13, -4, 1}, 
 {2, 8, 4, -2, 10, 40, 20, -10, -6, -36, -24, 6, 2, -4, -8, -2, 9, 11, -39, 7, 45, -137, -3, 35, -27, 123, -15, -21, 9, -25, 21, 7, 6, -20, 24, 2, 30, 44, -120, 10, -18, -48, 108, -6, 6, 16, -36, 2, 1, -5, -7, -1, 5, 23, 13, -5, -3, -21, -15, 3, 1, 7, 5, -1}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, 16, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, -16, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, -2, -8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 4, 18, 4, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, -74, 24, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 22, -72, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 18, 4, -2, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, -2, -10, -6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -10, 46, -14, -6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -10, -18, 50, -6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -10, -6, 2, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -8, 2, 0, 0, 0, 0, 0, -2, 8, 2, 0, 0, 0, 0, 0, -2, 8, 2, 0, 0, 0, 0, 0, -2, -8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, -4, 1, 0, 0, 0, 0, 0, -1, 4, 1, 0, 0, 0, 0, 0, -1, 4, 1, 0, 0, 0, 0, 0, -1, -4, 1, 0, 0, 0, 0, 0, -1, -4, 1, 0, 0, 0, 0, 0, -1, 4, 1, 0, 0, 0, 0, 0, -1, 4, 1, 0, 0, 0, 0, 0, -1, -4, 1, 0, 0, 0, 0, 0}, 
 {2, 9, 2, -1, 0, 0, 0, 0, 2, -7, -6, -1, 0, 0, 0, 0, 8, 11, -36, 5, 0, 0, 0, 0, 8, -21, 20, 5, 0, 0, 0, 0, 8, -21, 20, 5, 0, 0, 0, 0, 8, 11, -36, 5, 0, 0, 0, 0, 2, -7, -6, -1, 0, 0, 0, 0, 2, 9, 2, -1, 0, 0, 0, 0}, 
 {-1, -5, -3, 1, 0, 0, 0, 0, -1, 3, 5, 1, 0, 0, 0, 0, -5, -9, 25, -3, 0, 0, 0, 0, -5, 15, -15, -3, 0, 0, 0, 0, -5, 15, -15, -3, 0, 0, 0, 0, -5, -9, 25, -3, 0, 0, 0, 0, -1, 3, 5, 1, 0, 0, 0, 0, -1, -5, -3, 1, 0, 0, 0, 0}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 16, -4, 0, 14, -40, -14, 0, -8, 32, 8, 0, 2, -8, -2, 0, 4, -16, -4, 0, 14, 40, -14, 0, -8, -32, 8, 0, 2, 8, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {2, 8, -2, 0, 7, 28, -7, 0, -4, -32, 4, 0, 1, -4, -1, 0, 2, -8, -2, 0, 7, -28, -7, 0, -4, 32, 4, 0, 1, 4, -1, 0, 2, 8, -2, 0, 7, -20, -7, 0, -4, 16, 4, 0, 1, -4, -1, 0, 2, -8, -2, 0, 7, 20, -7, 0, -4, -16, 4, 0, 1, 4, -1, 0}, 
 {-4, -18, -4, 2, -14, -63, -14, 7, 8, 68, 24, -4, -2, 7, 6, 1, -16, -22, 72, -10, -56, 211, -36, -35, 32, -180, 32, 20, -8, 21, -20, -5, -16, 42, -40, -10, -56, -45, 196, -35, 32, 44, -144, 20, -8, -11, 36, -5, -4, 14, 12, 2, -14, -47, -6, 7, 8, 36, 8, -4, -2, -9, -2, 1}, 
 {2, 10, 6, -2, 7, 35, 21, -7, -4, -36, -28, 4, 1, -3, -5, -1, 10, 18, -50, 6, 35, -129, 17, 21, -20, 108, -12, -12, 5, -15, 15, 3, 10, -30, 30, 6, 35, 39, -135, 21, -20, -36, 100, -12, 5, 9, -25, 3, 2, -6, -10, -2, 7, 27, 13, -7, -4, -20, -12, 4, 1, 5, 3, -1}, 
 {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -8, 2, 0, -10, 24, 10, 0, 6, -24, -6, 0, -2, 8, 2, 0, -2, 8, 2, 0, -10, -24, 10, 0, 6, 24, -6, 0, -2, -8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
 {-1, -4, 1, 0, -5, -20, 5, 0, 3, 20, -3, 0, -1, 4, 1, 0, -1, 4, 1, 0, -5, 20, 5, 0, 3, -20, -3, 0, -1, -4, 1, 0, -1, -4, 1, 0, -5, 12, 5, 0, 3, -12, -3, 0, -1, 4, 1, 0, -1, 4, 1, 0, -5, -12, 5, 0, 3, 12, -3, 0, -1, -4, 1, 0}, 
 {2, 9, 2, -1, 10, 45, 10, -5, -6, -43, -14, 3, 2, -7, -6, -1, 8, 11, -36, 5, 40, -137, 12, 25, -24, 127, -28, -15, 8, -21, 20, 5, 8, -21, 20, 5, 40, 23, -124, 25, -24, -33, 108, -15, 8, 11, -36, 5, 2, -7, -6, -1, 10, 29, 2, -5, -6, -27, -6, 3, 2, 9, 2, -1}, 
 {-1, -5, -3, 1, -5, -25, -15, 5, 3, 23, 17, -3, -1, 3, 5, 1, -5, -9, 25, -3, -25, 83, -3, -15, 15, -77, 13, 9, -5, 15, -15, -3, -5, 15, -15, -3, -25, -21, 85, -15, 15, 27, -75, 9, -5, -9, 25, -3, -1, 3, 5, 1, -5, -17, -7, 5, 3, 15, 9, -3, -1, -5, -3, 1}};

int ijk2n(int i, int j, int k) {
  return(i+4*j+16*k);
}

void tricubic_get_coeff_stacked(double a[64], double x[64])
{
  int i,j;
  for (i=0;i<64;i++) 
    {
    a[i]=(double)(0.0);
    for (j=0;j<64;j++) 
      {
      a[i]+=A[i][j]*x[j];
      }
    a[i] = a[i]/8; /* A2 is the combination of A and the proper derivative operator as ints (requires a division by 8)  */
  }
}

double tricubic_eval(double a[64], double x, double y, double z)
{
  int i,j,k;
  double ret=(double)(0.0);
  /* TRICUBIC EVAL
     This is the short version of tricubic_eval. It is used to compute
     the value of the function at a given point (x,y,z). To compute
     partial derivatives of f, use the full version with the extra args.
  */
  for (i=0;i<4;i++) {
    for (j=0;j<4;j++) {
      for (k=0;k<4;k++) {
        ret+=a[ijk2n(i,j,k)]*pow(x,i)*pow(y,j)*pow(z,k);
      }
    }
  }
  return(ret);
}

void ev(double val[],double dx1[], double dx2[], double dx3[], double f[], int pos[], int indx[], int fx1, int fx2, int fx3, int ix)
{
  int i,j,k,l,iter = -1,gap1,gap2,loc,findx;
  double fin[64],a[64];
  gap1 = fx1 - 4;
  gap2 = fx1*(fx2 - 4);

 
  for(i=0;i < ix; i++)
    {
      
      /* generate matrix for input into interp, this
       is the first attempt at trying to speed up the 
      equation by forcing it more onto the C side*/
      loc = indx[i];
      if(iter != pos[loc])
  { 
	  findx = 0;
	  iter = pos[loc];
	    /* iter provides a unique identifier to the voxel of
		interest, and the code generates the interpolating
		coefficients once per voxel (at max). The evaluated points
		are sorted such that all values of a voxel are calculated
		in direct sequence. */
		
	    /* the padding of f (from python) allows for a lot of
	    	simplifcation, as its starts 1 off on every dimension */
	  for(l = 0;l < 4; l++)
	    {
	      for(k = 0;k < 4; k++)
		{
		  for(j = 0;j < 4; j++)
		    { 
		      fin[findx] = *(f + iter);
		      findx++;
		      iter++;
		    }
		  iter = iter + gap1;
		}	  
	      iter = iter + gap2;
	    }
	  iter = pos[loc];
	  tricubic_get_coeff_stacked(a,fin);


	}
      val[loc] = tricubic_eval(a,dx1[loc],dx2[loc],dx3[loc]);

    }
}
